"use strict";(self.webpackChunkdirectory=self.webpackChunkdirectory||[]).push([[4661],{4161:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>l,default:()=>y,frontMatter:()=>s,metadata:()=>c,toc:()=>u});var r=n(8168),o=n(8587),i=(n(6540),n(5680)),a=["components"],s={},l="Online PKI",c={unversionedId:"online-pki",id:"online-pki",title:"Online PKI",description:"OCSP and Remote CRLs",source:"@site/docs/online-pki.md",sourceDirName:".",slug:"/online-pki",permalink:"/directory/docs/online-pki",draft:!1,editUrl:"https://github.com/Wildboar-Software/directory/edit/main/website/docs/online-pki.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Transport Layer Security (TLS)",permalink:"/directory/docs/tls"},next:{title:"Signed Operations",permalink:"/directory/docs/signing"}},d={},u=[{value:"OCSP and Remote CRLs",id:"ocsp-and-remote-crls",level:2},{value:"Pros",id:"pros",level:3},{value:"Cons",id:"cons",level:3},{value:"Recommendation",id:"recommendation",level:3},{value:"Answering OCSP Requests",id:"answering-ocsp-requests",level:3},{value:"Server-Based Certificate Validation Protocol (SCVP)",id:"server-based-certificate-validation-protocol-scvp",level:2}],p={toc:u},f="wrapper";function y(e){var t=e.components,n=(0,o.A)(e,a);return(0,i.yg)(f,(0,r.A)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,i.yg)("h1",{id:"online-pki"},"Online PKI"),(0,i.yg)("h2",{id:"ocsp-and-remote-crls"},"OCSP and Remote CRLs"),(0,i.yg)("p",null,"It is important that you understand the risks of using the\n",(0,i.yg)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Online_Certificate_Status_Protocol"},"Online Certificate Status Protocol (OCSP)"),"\nand/or remote CRLs for the validation of a certificate chain. These features can\nbe useful for obtaining timely notification of certificate revocation. However,\nthese features also come at cost."),(0,i.yg)("h3",{id:"pros"},"Pros"),(0,i.yg)("p",null,"You can get up-to-date information on certificate revocation. This means that,\nif somebody's private key gets hacked, their certificate can get added to the\nOCSP responder's list of revoked certificates, and your DSA will know about it\nas soon as the OCSP responder is queried again for that certificate's status.\nThe same can be said for remote CRLs."),(0,i.yg)("h3",{id:"cons"},"Cons"),(0,i.yg)("p",null,"The first downside is latency. Since both OCSP and remote CRLs require network\nrequests, they will introduce high latency to the verification. If your DSA's\nusers are submitting many requests synchronously, and in rapid succession, such\nas may be the case in bulk-loading, the latency introduced may be unacceptable."),(0,i.yg)("p",null,"Meerkat DSA currently caches recently fetched remote CRLs, but this is currently\nnot configurable. Meerkat DSA does not cache OCSP responses at all."),(0,i.yg)("p",null,"The second downside is, ironically, security vulnerabilities: enabling these\nfeatures means that user inputs can make your Meerkat DSA make certain requests\nto arbitrary hosts/services. This can be used (among other things) by attackers\nto scan your network. Meerkat DSA does not really have any defense against this\ncurrently (one possible defense would be to block the use of IP addresses as\nCRL distribution points and OCSP responders entirely, but this requires further\nstudy)."),(0,i.yg)("admonition",{type:"tip"},(0,i.yg)("p",{parentName:"admonition"},"No matter what Meerkat DSA implements, you should always secure your\nnetwork. If you are using Kubernetes, you can (and should) configure network\npolicies. Generally speaking, Meerkat DSA does not need to access anything in\nyour internal network except for the MySQL database.")),(0,i.yg)("p",null,(0,i.yg)("a",{parentName:"p",href:"https://liveoverflow.com/gitlab-11-4-7-remote-code-execution-real-world-ctf-2018/"},"Here is an example of what can go wrong if you enable these"),"."),(0,i.yg)("h3",{id:"recommendation"},"Recommendation"),(0,i.yg)("p",null,"By default, OCSP and remote CRL checking are ",(0,i.yg)("em",{parentName:"p"},"disabled")," in Meerkat DSA. It is\nthe opinion of the developer of Meerkat DSA, Jonathan Wilbur, that the risks of\nenabling these protocols outweighs the gains to be had from a more timely\nnotification of certificate revocation (which should be an infrequent event in\ngeneral)."),(0,i.yg)("p",null,"In lieu thereof, it is recommended to implement automation to obtain up-to-date\nCRLs and simply update the\n",(0,i.yg)("a",{parentName:"p",href:"/directory/docs/env#meerkatsigningcrlfile"},(0,i.yg)("inlineCode",{parentName:"a"},"MEERKAT_SIGNING_CRL_FILE"))," file and restart\nMeerkat DSA every so often so that it is up-to-date. This will be far more\nperformant, far more secure, and can still give you very fresh information, if\nyou choose to update it frequently."),(0,i.yg)("h3",{id:"answering-ocsp-requests"},"Answering OCSP Requests"),(0,i.yg)("p",null,"Meerkat DSA can also be configured to provide OCSP requests for its own\nconfigured TLS certificate on demand. If\n",(0,i.yg)("a",{parentName:"p",href:"/directory/docs/env#meerkattlsanswerocsprequests"},(0,i.yg)("inlineCode",{parentName:"a"},"MEERKAT_TLS_ANSWER_OCSP_REQUESTS"))," is\nset to ",(0,i.yg)("inlineCode",{parentName:"p"},"1")," (enabled), Meerkat DSA will staple OCSP requests in the TLS\nhandshake. This option does not affect how Meerkat DSA validates other TLS or\nsigning peers."),(0,i.yg)("p",null,"Meerkat DSA only responds to OCSP requests over implicit TLS (not StartTLS)."),(0,i.yg)("h2",{id:"server-based-certificate-validation-protocol-scvp"},"Server-Based Certificate Validation Protocol (SCVP)"),(0,i.yg)("p",null,"Meerkat DSA does not currently support\n",(0,i.yg)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/SCVP"},"Server-Based Certificate Validation Protocol (SCVP)"),",\nbut it will eventually. This means that, when presented with a signed arguments,\nresults, or errors, along with a certificate or certificate chain, Meerkat DSA\nwill be able to offload the verification of the digital signatures and the\ncertification path to the SCVP server. This may also have the benefit of finer\ncontrols over the certification path verification that would make Meerkat DSA\ntoo bloated if implemented."))}y.isMDXComponent=!0},5680:(e,t,n)=>{n.d(t,{xA:()=>d,yg:()=>y});var r=n(6540);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},d=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},u="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},f=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),u=c(n),f=o,y=u["".concat(l,".").concat(f)]||u[f]||p[f]||i;return n?r.createElement(y,a(a({ref:t},d),{},{components:n})):r.createElement(y,a({ref:t},d))}));function y(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,a=new Array(i);a[0]=f;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[u]="string"==typeof e?e:o,a[1]=s;for(var c=2;c<i;c++)a[c]=n[c];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}f.displayName="MDXCreateElement"}}]);