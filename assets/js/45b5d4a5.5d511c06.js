"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3607],{1184:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>a});var t=r(4041);const o={},s=t.createContext(o);function i(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),t.createElement(s.Provider,{value:n},e.children)}},8086:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"networking","title":"Networking","description":"Preface on Directory Protocols","source":"@site/docs/networking.md","sourceDirName":".","slug":"/networking","permalink":"/directory/docs/networking","draft":false,"unlisted":false,"editUrl":"https://github.com/Wildboar-Software/directory/edit/main/website/docs/networking.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Schema Administration","permalink":"/directory/docs/schema"},"next":{"title":"Distributed Operations","permalink":"/directory/docs/distributed"}}');var o=r(1085),s=r(1184);const i={},a="Networking",c={},l=[{value:"Preface on Directory Protocols",id:"preface-on-directory-protocols",level:2},{value:"Directory Transport Protocols",id:"directory-transport-protocols",level:2},{value:"Distributed Operation",id:"distributed-operation",level:2},{value:"DNS Configuration",id:"dns-configuration",level:2},{value:"DNS Records",id:"dns-records",level:3},{value:"DNS Client",id:"dns-client",level:3},{value:"The Future",id:"the-future",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"networking",children:"Networking"})}),"\n",(0,o.jsx)(n.h2,{id:"preface-on-directory-protocols",children:"Preface on Directory Protocols"}),"\n",(0,o.jsxs)(n.p,{children:["In TCP/IP networking, there is generally a one-to-one correspondence between a\r\nTCP port and a protocol. You don't usually listen on a given TCP port for, say,\r\nboth HTTP and FTP and SSH traffic. In directory systems, network transport is\r\nlogically separated from the ",(0,o.jsx)(n.em,{children:"session"}),', such that you can reuse the same\r\ntransport connection to relay multiple protocols. Hence, to clarify the use of\r\nterminology here, a "transport" means the stack of protocols by which two\r\nhosts are networked and X.500 operations are relayed between them, and an\r\n"association" is a logical connection established by a bind operation that is\r\ntransported over a "transport." Within the same transport, multiple associations\r\nmay be made serially (but not in parallel), via binding and unbinding.']}),"\n",(0,o.jsx)(n.p,{children:'This means that, when Meerkat DSA listens for IDM transport on a given TCP port,\r\nDAP, DOP, DISP, and DSP associations may be established using IDM transport on\r\nthat TCP port. This defies the usual "one-port-per-service" model often used by\r\nTCP/IP services.'}),"\n",(0,o.jsxs)(n.p,{children:["Note that the above does ",(0,o.jsx)(n.em,{children:"not"}),' apply to LDAP, since LDAP is ALWAYS transported\r\nover "raw" TCP without IDM, ITOT, or any other OSI transport mechanism layered\r\non top.']}),"\n",(0,o.jsx)(n.h2,{id:"directory-transport-protocols",children:"Directory Transport Protocols"}),"\n",(0,o.jsx)(n.p,{children:"Currently, Meerkat DSA only supports the transport of X.500 protocols via IDM\r\nor IDMS (IDM encapsulated in TLS).\r\nLDAP may be used as well, and may be optionally encapsulated in TLS. For both\r\ncategories of protocols, StartTLS may be used as well."}),"\n",(0,o.jsx)(n.p,{children:"The protocols which Meerkat DSA uses can be controlled by the following\r\nenvironment variables, which specify the port number on which these services\r\nlisten:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"MEERKAT_WEB_ADMIN_PORT"})," (Recommended: 18080; be careful when exposing this.)"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"MEERKAT_IDM_PORT"})," (Recommended: 4632)"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"MEERKAT_IDMS_PORT"})," (Recommended: 44632)"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"MEERKAT_ITOT_PORT"})," (Recommended: 1102)"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"MEERKAT_ITOTS_PORT"})," (Recommended: 11102)"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"MEERKAT_LDAP_PORT"})," (Recommended: 389; requires root privileges)"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"MEERKAT_LDAPS_PORT"})," (Recommended: 636; requires root privileges)"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"If a port number is set, Meerkat DSA listens on that port for the given service.\r\nIf no port is set, that service does not listen at all. This means that it is\r\npossible to run Meerkat DSA as an LDAP-only or X.500-only server by simply\r\nnot configuring ports for those services."}),"\n",(0,o.jsx)(n.h2,{id:"distributed-operation",children:"Distributed Operation"}),"\n",(0,o.jsxs)(n.p,{children:["For distributed operations, Meerkat DSA stores the access points obtained from\r\nknowledge attributes in the ",(0,o.jsx)(n.code,{children:"AccessPoint"})," table. Currently, Meerkat DSA can only\r\nmake use of IDM-based (and IDMS-based) access points. All other access points\r\nwill be ignored."]}),"\n",(0,o.jsxs)(n.p,{children:["You may directly alter the rows in the ",(0,o.jsx)(n.code,{children:"AccessPoint"}),' table to add or remove\r\naccess points, but Meerkat DSA may have to be restarted for your changes to\r\ntake effect. (We say "may" literally: it might not require a restart if you are\r\nnot using in-memory caching of the DIT.) It is recommended that you instead use\r\nthe Directory Access Protocol with the ',(0,o.jsx)(n.code,{children:"manageDSAIT"})," flag set to modify\r\nknowledge attributes rather than altering the database directly."]}),"\n",(0,o.jsx)(n.h2,{id:"dns-configuration",children:"DNS Configuration"}),"\n",(0,o.jsx)(n.h3,{id:"dns-records",children:"DNS Records"}),"\n",(0,o.jsxs)(n.p,{children:["It is not necessary at all, but for the sake of service discovery, it is\r\nrecommended that you configure DNS for your domain to name your directory as\r\na service using ",(0,o.jsx)(n.code,{children:"SRV"})," records. If you want to keep your directory a secret, it\r\nis advised that you refrain from exposing it to the global Internet at all."]}),"\n",(0,o.jsx)(n.p,{children:"SRV records should be defined for IDM, IDMS, LDAP, and LDAPS like so:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"_idm._tcp.example.com 3600 IN SRV 0 5 <IDM port number> dsa01.example.com\r\n_idms._tcp.example.com 3600 IN SRV 0 5 <IDMS port number> dsa01.example.com\r\n_itot._tcp.example.com 3600 IN SRV 0 5 <IDMS port number> dsa01.example.com\r\n_ldap._tcp.example.com 3600 IN SRV 0 5 <LDAP port number> dsa01.example.com\r\n_ldaps._tcp.example.com 3600 IN SRV 0 5 <LDAPS port number> dsa01.example.com\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Note that, in the above example you will need to swap out ",(0,o.jsx)(n.code,{children:"example.com"})," with\r\nyour domain, ",(0,o.jsx)(n.code,{children:"dsa01"})," with your DSA's host name, the port numbers enclosed in\r\nbrackets above and configure the other SRV record parameters as you see fit."]}),"\n",(0,o.jsx)(n.p,{children:"You will also need A and/or AAAA records corresponding to the hostnames on the\r\nright hand side of the SRV records."}),"\n",(0,o.jsx)(n.p,{children:"Again, DNS configuration is NOT required for Meerkat DSA to work."}),"\n",(0,o.jsx)(n.h3,{id:"dns-client",children:"DNS Client"}),"\n",(0,o.jsxs)(n.p,{children:["Meerkat DSA runs on NodeJS, which uses the ",(0,o.jsx)(n.code,{children:"c-ares"})," library under the hood.\r\nNodeJS does not expose any functionality for tuning DNS resolution. Fortunately,\r\nyou can tune it using the ",(0,o.jsx)(n.code,{children:"RES_OPTIONS"})," environment variable, which is\r\ndocumented ",(0,o.jsx)(n.a,{href:"https://manpages.ubuntu.com/manpages/kinetic/en/man3/ares_init_options.3.html",children:"here"}),"."]}),"\n",(0,o.jsx)(n.p,{children:"You generally should not mess with this unless you're seeing DNS resolution\r\nissues. I have personally seen this happen when I change networks while still\r\nconnected to a VPN, but I think this is a pretty uncommon issue."}),"\n",(0,o.jsxs)(n.p,{children:["See ",(0,o.jsx)(n.a,{href:"https://stackoverflow.com/a/45403565/6562635",children:"this StackOverflow answer"}),"\r\nfor help."]}),"\n",(0,o.jsx)(n.admonition,{type:"info",children:(0,o.jsxs)(n.p,{children:["This is liable to change if ",(0,o.jsx)(n.a,{href:"https://bun.sh/",children:"Bun"})," proves to be a viable NodeJS\r\nalternative. I do not know what it uses for DNS under the hood."]})}),"\n",(0,o.jsx)(n.h2,{id:"the-future",children:"The Future"}),"\n",(0,o.jsx)(n.p,{children:"In the future, Meerkat DSA may support:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"TOR / Onion Routing / SOCKS Transport"}),"\n",(0,o.jsx)(n.li,{children:"Lightweight Presentation Protocol (LPP) Transport"}),"\n",(0,o.jsx)(n.li,{children:"X.25-over-TCP (XOT) Transport"}),"\n",(0,o.jsx)(n.li,{children:"DIXIE Protocol"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}}}]);