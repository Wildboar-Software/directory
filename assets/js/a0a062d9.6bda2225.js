"use strict";(self.webpackChunkdirectory=self.webpackChunkdirectory||[]).push([[39],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>u});var i=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=i.createContext({}),c=function(e){var t=i.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},d=function(e){var t=c(e.components);return i.createElement(s.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},h=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),h=c(n),u=a,p=h["".concat(s,".").concat(u)]||h[u]||m[u]||o;return n?i.createElement(p,r(r({ref:t},d),{},{components:n})):i.createElement(p,r({ref:t},d))}));function u(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,r=new Array(o);r[0]=h;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,r[1]=l;for(var c=2;c<o;c++)r[c]=n[c];return i.createElement.apply(null,r)}return i.createElement.apply(null,n)}h.displayName="MDXCreateElement"},1270:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>s,default:()=>u,frontMatter:()=>l,metadata:()=>c,toc:()=>m});var i=n(7462),a=n(3366),o=(n(7294),n(3905)),r=["components"],l={},s="Authorization",c={unversionedId:"authorization",id:"authorization",title:"Authorization",description:"Meerkat currently only supports the Basic Access Control and Simplified Access",source:"@site/docs/authorization.md",sourceDirName:".",slug:"/authorization",permalink:"/directory/docs/authorization",draft:!1,editUrl:"https://github.com/Wildboar-Software/directory/edit/main/website/docs/authorization.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Database Administration",permalink:"/directory/docs/database"},next:{title:"Authentication",permalink:"/directory/docs/authentication"}},d={},m=[{value:"Enabling Access Controls",id:"enabling-access-controls",level:2},{value:"Getting Locked Out",id:"getting-locked-out",level:2},{value:"Disabling Access Controls",id:"disabling-access-controls",level:3},{value:"Deleting an ACI Item from the database",id:"deleting-an-aci-item-from-the-database",level:3},{value:"Access Controls in Hierarchical Operational Bindings",id:"access-controls-in-hierarchical-operational-bindings",level:2},{value:"Recommendation Access Control",id:"recommendation-access-control",level:2},{value:"Access Control in a Distributed Environment",id:"access-control-in-a-distributed-environment",level:2},{value:"Setting the Local Qualifier of a Client",id:"setting-the-local-qualifier-of-a-client",level:2}],h={toc:m};function u(e){var t=e.components,n=(0,a.Z)(e,r);return(0,o.kt)("wrapper",(0,i.Z)({},h,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"authorization"},"Authorization"),(0,o.kt)("p",null,"Meerkat currently only supports the Basic Access Control and Simplified Access\nControl schemes defined in\n",(0,o.kt)("a",{parentName:"p",href:"https://www.itu.int/rec/T-REC-X.501/en"},"ITU Recommendation X.501"),". Future\nversions may implement:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Rule-Based Access Control"),(0,o.kt)("li",{parentName:"ul"},'A "points-based" access control scheme'),(0,o.kt)("li",{parentName:"ul"},'An "OpenLDAP-like" access control scheme')),(0,o.kt)("p",null,"This documentation will not discuss how Basic Access Control or Simplified\nAccess Control works; only the implementation-specific details that apply to\nMeerkat DSA."),(0,o.kt)("h2",{id:"enabling-access-controls"},"Enabling Access Controls"),(0,o.kt)("p",null,"Access control does not exist in Meerkat DSA (and the directory as a whole) by\ndefault. It must be configured. For Meerkat DSA to observe access controls for a\ngiven Access Control Specific Area (ACSA), the following must be in place:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"There must be an administrative point defined with an ",(0,o.kt)("inlineCode",{parentName:"li"},"administrativeRole"),"\nattribute value of ",(0,o.kt)("inlineCode",{parentName:"li"},"id-ar-autonomousArea")," (2.5.23.1)."),(0,o.kt)("li",{parentName:"ol"},"There must be an administrative point defined with an ",(0,o.kt)("inlineCode",{parentName:"li"},"administrativeRole"),"\nattribute value of ",(0,o.kt)("inlineCode",{parentName:"li"},"id-ar-accessControlSpecificArea")," (2.5.23.2). The entry\nused for this administrative point may be the same as the entry used for the\nautonomous administrative point. (An administrative point may have multiple\nroles.)"),(0,o.kt)("li",{parentName:"ol"},"The access control administrative point must have an ",(0,o.kt)("inlineCode",{parentName:"li"},"accessControlScheme"),"\nattribute value of ",(0,o.kt)("inlineCode",{parentName:"li"},"basicAccessControlScheme")," (2.5.28.1) or\n",(0,o.kt)("inlineCode",{parentName:"li"},"simplifiedAccessControlScheme")," (2.5.28.2), depending on what you want.",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Note that, if you use the ",(0,o.kt)("inlineCode",{parentName:"li"},"rule-and-basic-access-control")," or\n",(0,o.kt)("inlineCode",{parentName:"li"},"rule-and-simple-access-control"),' access control schemes instead, they will\nfollow the semantics of the Basic Access Control and Simplified Access\nControl schemes; the "rule-based" aspects of these access control schemes\nwill be ignored, however, because Meerkat DSA does not understand\nrule-based access control, and some access control is usually preferrable\nto none.')))),(0,o.kt)("p",null,"Note that the ACI items should be created before enabling access control. If\nthere are no ACI items defined at all, then ",(0,o.kt)("em",{parentName:"p"},"nobody")," is permitted to do\n",(0,o.kt)("em",{parentName:"p"},"anything"),". It is possible for administrators to accidentally configure\nrules that prevent even themselves from accessing their own DSA!"),(0,o.kt)("h2",{id:"getting-locked-out"},"Getting Locked Out"),(0,o.kt)("p",null,"If an administrator gets locked out of Meerkat DSA by having misconfigured\naccess controls, it will have to be corrected by directly modifying the\ndatabase to achieve one of the following goals:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"To ensure that one of the conditions stated above for enabling access controls\nis no longer met, and thereby disable authorization for that ACSA entirely."),(0,o.kt)("li",{parentName:"ul"},"To delete the offending ACI item.")),(0,o.kt)("p",null,"The former option should be used when administrators don't know what they did\nwrong, or when the ACSA does not contain any private information; it is quicker\nand easier to just disable access control entirely, fix the problem, then\nre-enable access controls once it is fixed. If administrators know which ACI\nitem is causing them to be locked out, the latter option may preferrable."),(0,o.kt)("p",null,'One way you can "delete" an ACI item is by changing the ',(0,o.kt)("inlineCode",{parentName:"p"},"active")," column in the\n",(0,o.kt)("inlineCode",{parentName:"p"},"ACIItem")," table in the database to ",(0,o.kt)("inlineCode",{parentName:"p"},"FALSE")," for that ACI item."),(0,o.kt)("h3",{id:"disabling-access-controls"},"Disabling Access Controls"),(0,o.kt)("p",null,"The easiest way to do this with minimal loss of data is to delete the\naccess control scheme attribute value from the ",(0,o.kt)("inlineCode",{parentName:"p"},"EntryAccessControlScheme")," table.\nThe administrator will have to determine the ID of the entry that is the\nadministrative point for the ACSA so he can delete the correct access control\nscheme value. It may be helpful to inspect the ",(0,o.kt)("inlineCode",{parentName:"p"},"EntryAdministrativeRole")," table\nto determine the ID of the offending administrative point."),(0,o.kt)("p",null,"Note that Meerkat DSA will have to be restarted for this change to take effect,\nsince the access control scheme may still be cached in memory."),(0,o.kt)("h3",{id:"deleting-an-aci-item-from-the-database"},"Deleting an ACI Item from the database"),(0,o.kt)("p",null,"ACI items may be deleted from the ",(0,o.kt)("inlineCode",{parentName:"p"},"ACIItem")," table."),(0,o.kt)("p",null,"Note that Meerkat DSA may have to be restarted for this change to take effect,\nsince the ACI items may still be cached in memory."),(0,o.kt)("p",null,'Another way you can "delete" an ACI item is by changing the ',(0,o.kt)("inlineCode",{parentName:"p"},"active")," column in\nthe ",(0,o.kt)("inlineCode",{parentName:"p"},"ACIItem")," table in the database to ",(0,o.kt)("inlineCode",{parentName:"p"},"FALSE")," for that ACI item."),(0,o.kt)("h2",{id:"access-controls-in-hierarchical-operational-bindings"},"Access Controls in Hierarchical Operational Bindings"),(0,o.kt)("p",null,"When Meerkat DSA establishes itself as a subordinate DSA in a Hierarchical\nOperational Binding (HOB), it will honor all administrative points that lie\nwithin the naming context up until and including the closest Autonomous\nAdministrative Point (AAP). In other words, if a Meerkat DSA does not define its\nnewly minted context prefix to be an Autonomous Administrative Point (AAP), it\nmay be governed by the access controls (and other administrative controls) of\nthe superior DSA. To be clear, this is the correct behavior for an X.500\ndirectory--not an accidental nuance of Meerkat DSA. Unless you are okay with\nthe superior DSA having ",(0,o.kt)("em",{parentName:"p"},"complete control")," over the subordinate naming context\nthat you establish with it, you should define each new context prefix to be\nan Autonomous Administrative Point (AAP) and each should be an access control\nadministrative point with the desired access controls configured."),(0,o.kt)("p",null,"Everything stated above will also apply to Non-Specific Hierarchical Operational\nBindings (NHOBs), even though these are not yet supported in Meerkat DSA."),(0,o.kt)("p",null,"To clarify with an example, let's say that the administrator for C=US wishes to\nestablish your DSA as the owner of ",(0,o.kt)("inlineCode",{parentName:"p"},"C=US,ST=FL")," and everything below it. He does\nthis by submitting an ",(0,o.kt)("inlineCode",{parentName:"p"},"addEntry")," request to his DSA with ",(0,o.kt)("inlineCode",{parentName:"p"},"targetSystem")," set to\nyour DSA, which triggers his DSA to attempt to establish an HOB with your DSA.\nIf you accept the hierarchical operational binding, the DSA for ",(0,o.kt)("inlineCode",{parentName:"p"},"C=US")," will now\nredirect (chain) all operations within the namespace ",(0,o.kt)("inlineCode",{parentName:"p"},"C=US,ST=FL")," to your DSA."),(0,o.kt)("p",null,"If the administrator for ",(0,o.kt)("inlineCode",{parentName:"p"},"C=US")," has defined an Access Control Specific Area\n(ACSA) with ",(0,o.kt)("inlineCode",{parentName:"p"},"C=US")," as the administrative point that makes ",(0,o.kt)("inlineCode",{parentName:"p"},"C=US,ST=FL,L=Tampa"),"\nworld-writeable, the DSA for ",(0,o.kt)("inlineCode",{parentName:"p"},"C=US,ST=FL")," would still honor this configuration,\nand permit all writes to ",(0,o.kt)("inlineCode",{parentName:"p"},"C=US,ST=FL,L=Tampa")," even though the rule permitting it\nis external and superior to your DSA. The creation of an\nAutonomous Administrative Point (AAP) that halts the propagation of access\ncontrol rules (ACI items, for instance) from superior DSAs would prevent this\nbehavior."),(0,o.kt)("h2",{id:"recommendation-access-control"},"Recommendation Access Control"),(0,o.kt)("p",null,"While DSA administrators will likely use their DSAs differently, there are a few\ncommonalities particular to access controls that almost all uses of X.500\ndirectory services will find useful. For use common use cases, access controls\nshould be defined that:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Allow administrators to administer."),(0,o.kt)("li",{parentName:"ul"},"Allow users to change their password.",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"There are perfectly good arguments to ",(0,o.kt)("em",{parentName:"li"},"not")," allowing this, too. It may be\npreferrable to have secure system-generated passwords instead; in this case,\nadministrators should implement access controls that ",(0,o.kt)("em",{parentName:"li"},"prevent")," users from\nmodifying their passwords so that a service can do this on their behalf."))),(0,o.kt)("li",{parentName:"ul"},"Explicitly prohibit users from changing the passwords of others."),(0,o.kt)("li",{parentName:"ul"},"Explicitly allow administrators to change the passwords of others."),(0,o.kt)("li",{parentName:"ul"},"Allow users to read their entire entry.",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"This should include the child entries if the user's entry is a compound\nentry."))),(0,o.kt)("li",{parentName:"ul"},"Allow users to modify certain attributes of their entry.",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"For example, administrators may not want users to be able to change their\n",(0,o.kt)("inlineCode",{parentName:"li"},"employeeID")," attribute, but may want to allow users to change their\nemergency contact information as they please."))),(0,o.kt)("li",{parentName:"ul"},"Explicitly prohibit users from adding new entries, except within permitted\nsubtrees."),(0,o.kt)("li",{parentName:"ul"},"Explicitly prohibit users from modifying or deleting entries that they did not\nauthor."),(0,o.kt)("li",{parentName:"ul"},"Carefully choose which users can modify ",(0,o.kt)("inlineCode",{parentName:"li"},"hierarchyParent")," and\n",(0,o.kt)("inlineCode",{parentName:"li"},"aliasedEntryName"),", because these attributes could be used to initiate attacks\nagainst the directory (e.g. trying to exploit a bug in access control by\nusing aliases or attempting to enumerate entries with timing attacks via the\n",(0,o.kt)("inlineCode",{parentName:"li"},"hierarchyParent")," attribute validation.)")),(0,o.kt)("h2",{id:"access-control-in-a-distributed-environment"},"Access Control in a Distributed Environment"),(0,o.kt)("p",null,"Meerkat DSA makes access control decisions based upon local information, but, in\na distributed environment, authentication information may come from other DSAs.\nHow this authentication information itself is authenticated is a topic in its\nown right, which is documented\n",(0,o.kt)("a",{parentName:"p",href:"/directory/docs/distributed#authentication-of-distributed-operations"},"here"),"."),(0,o.kt)("h2",{id:"setting-the-local-qualifier-of-a-client"},"Setting the Local Qualifier of a Client"),(0,o.kt)("p",null,"The meaning of the ",(0,o.kt)("inlineCode",{parentName:"p"},"localQualifier")," component of the ",(0,o.kt)("inlineCode",{parentName:"p"},"AuthenticationLevel")," as\ndescribed in ",(0,o.kt)("a",{parentName:"p",href:"https://www.itu.int/rec/T-REC-X.501/en"},"ITU Recommendation X.501 (2019)"),",\nSection 18.4.2.3, is left to DSA implementations. In Meerkat DSA the\n",(0,o.kt)("inlineCode",{parentName:"p"},"localQualifier")," is given a value depending on the level of transport security\nthat is used to protect a connection with a client."),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"localQualifier"),' is a simple integer, and Meerkat DSA adds "points" to this\ninteger, depending on configuration. A different number of points may be granted\nfor more or less secure transports. For instance, TLSv1.3 could be (and usually\nshould be) granted more ',(0,o.kt)("inlineCode",{parentName:"p"},"localQualifier"),' "points" than SSLv3, which is\ncompletely insecure (but better than nothing).'),(0,o.kt)("p",null,"The environment variables that are used to configure the ",(0,o.kt)("inlineCode",{parentName:"p"},"localQualifier")," are:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/directory/docs/env#meerkatlocalqualifierpointsforusingssl3"},(0,o.kt)("inlineCode",{parentName:"a"},"MEERKAT_LOCAL_QUALIFIER_POINTS_FOR_USING_SSL3"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/directory/docs/env#meerkatlocalqualifierpointsforusingstarttls"},(0,o.kt)("inlineCode",{parentName:"a"},"MEERKAT_LOCAL_QUALIFIER_POINTS_FOR_USING_STARTTLS"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/directory/docs/env#meerkatlocalqualifierpointsforusingtls"},(0,o.kt)("inlineCode",{parentName:"a"},"MEERKAT_LOCAL_QUALIFIER_POINTS_FOR_USING_TLS"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/directory/docs/env#meerkatlocalqualifierpointsforusingtls10"},(0,o.kt)("inlineCode",{parentName:"a"},"MEERKAT_LOCAL_QUALIFIER_POINTS_FOR_USING_TLS_1_0"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/directory/docs/env#meerkatlocalqualifierpointsforusingtls11"},(0,o.kt)("inlineCode",{parentName:"a"},"MEERKAT_LOCAL_QUALIFIER_POINTS_FOR_USING_TLS_1_1"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/directory/docs/env#meerkatlocalqualifierpointsforusingtls12"},(0,o.kt)("inlineCode",{parentName:"a"},"MEERKAT_LOCAL_QUALIFIER_POINTS_FOR_USING_TLS_1_2"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/directory/docs/env#meerkatlocalqualifierpointsforusingtls13"},(0,o.kt)("inlineCode",{parentName:"a"},"MEERKAT_LOCAL_QUALIFIER_POINTS_FOR_USING_TLS_1_3")))))}u.isMDXComponent=!0}}]);