"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6770],{1184:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>a});var t=i(4041);const r={},s=t.createContext(r);function o(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(s.Provider,{value:n},e.children)}},4530:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"signing","title":"Signed Operations","description":"Meerkat DSA fully supports signed arguments, results, and errors as described in","source":"@site/docs/signing.md","sourceDirName":".","slug":"/signing","permalink":"/directory/docs/signing","draft":false,"unlisted":false,"editUrl":"https://github.com/Wildboar-Software/directory/edit/main/website/docs/signing.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Online PKI","permalink":"/directory/docs/online-pki"},"next":{"title":"Operational Bindings","permalink":"/directory/docs/opbinding"}}');var r=i(1085),s=i(1184);const o={},a="Signed Operations",d={},c=[{value:"What is Signing?",id:"what-is-signing",level:2},{value:"Configuring Signing",id:"configuring-signing",level:2},{value:"Verification of Signed Data",id:"verification-of-signed-data",level:2},{value:"Authorization for Signed Results and Errors",id:"authorization-for-signed-results-and-errors",level:2},{value:"How to Request Signed Results or Errors",id:"how-to-request-signed-results-or-errors",level:2},{value:"How Signing Affects Pagination and Chaining",id:"how-signing-affects-pagination-and-chaining",level:2},{value:"Signing of Bind Results",id:"signing-of-bind-results",level:2},{value:"Implementation",id:"implementation",level:2}];function l(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"signed-operations",children:"Signed Operations"})}),"\n",(0,r.jsxs)(n.p,{children:["Meerkat DSA fully supports signed arguments, results, and errors as described in\n",(0,r.jsx)(n.a,{href:"https://www.itu.int/rec/T-REC-X.501-201910-I/en",children:"ITU Recommendation X.501 (2019)"}),',\nSection 17.3, simply referred to in this documentation as "signing."']}),"\n",(0,r.jsx)(n.h2,{id:"what-is-signing",children:"What is Signing?"}),"\n",(0,r.jsxs)(n.p,{children:["In addition to the point-to-point security provided by TLS, X.500 directories\nensure the integrity of data as it is relayed from DSA to DSA via cryptographic\nsignatures applied to results or errors. Since, by design, a DSA might be an\nintermediary between a client and another DSA, it is necessary for signing to\nexist to ensure that the intermediate DSA can spoof results or errors that it\nclaims to have originated from another DSA. To be clear, TLS only provides\nconfidentiality and integrity of data transfered between one server to another,\nbut not for the data that is ",(0,r.jsx)(n.em,{children:"relayed"})," between servers, thereby necessitating\nsigning. TLS provides point-to-point confidentiality and integrity. Signing\nprovides end-to-end integrity, but not confidentiality."]}),"\n",(0,r.jsx)(n.h2,{id:"configuring-signing",children:"Configuring Signing"}),"\n",(0,r.jsxs)(n.p,{children:["Signing is configured, like ",(0,r.jsx)(n.a,{href:"/directory/docs/env",children:"all other configuration options"}),", by\nenvironment variables. The environment variables used for configuring signing\nstart with ",(0,r.jsx)(n.code,{children:"MEERKAT_SIGNING_"}),". You will notice some that start with\n",(0,r.jsx)(n.code,{children:"MEERKAT_SIGNING_BIND_"}),'; these variables are what is referred to as "bind\noverrides," which are discussed ',(0,r.jsx)(n.a,{href:"/directory/docs/env#tls-and-signing-options",children:"here"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["At minimum, you MUST define a\n",(0,r.jsx)(n.a,{href:"/directory/docs/env#meerkat_signing_certs_chain_file",children:(0,r.jsx)(n.code,{children:"MEERKAT_SIGNING_CERTS_CHAIN_FILE"})})," and\n",(0,r.jsx)(n.a,{href:"/directory/docs/env#meerkat_signing_key_file",children:(0,r.jsx)(n.code,{children:"MEERKAT_SIGNING_KEY_FILE"})})," to enable signing.\nNotably, Meerkat DSA determines its Application Entity Title (AE-Title) from the\nsigning certificate. (NOT the TLS certificate.)"]}),"\n",(0,r.jsxs)(n.p,{children:["You will probably also want to define a separate set of trust anchors for\nsigning than for TLS. You can do this via the\n",(0,r.jsx)(n.a,{href:"/directory/docs/env#meerkat_signing_ca_file",children:(0,r.jsx)(n.code,{children:"MEERKAT_SIGNING_CA_FILE"})})," and\n",(0,r.jsx)(n.a,{href:"/directory/docs/env#meerkat_trust_anchors_file",children:(0,r.jsx)(n.code,{children:"MEERKAT_TRUST_ANCHORS_FILE"})})," environment\nvariables."]}),"\n",(0,r.jsx)(n.admonition,{type:"warning",children:(0,r.jsx)(n.p,{children:"If you do not configure signing trust anchors, the same trust anchors used for\nTLS will be used to verify digital signatures on arguments, results, and errors."})}),"\n",(0,r.jsxs)(n.p,{children:["By default, Meerkat DSA will check neither remote CRLs (given in an X.509\ncertificate's ",(0,r.jsx)(n.code,{children:"cRLDistributionPoints"})," extension) nor OCSP responders for the\nvalidity of a certificate used in signing unless these are turned on using the\n",(0,r.jsx)(n.a,{href:"/directory/docs/env#meerkat_signing_remote_crl_checkiness",children:(0,r.jsx)(n.code,{children:"MEERKAT_SIGNING_REMOTE_CRL_CHECKINESS"})}),"\nand ",(0,r.jsx)(n.a,{href:"/directory/docs/env#meerkat_signing_ocsp_checkiness",children:(0,r.jsx)(n.code,{children:"MEERKAT_SIGNING_OCSP_CHECKINESS"})}),"\noptions. Before enabling these, you should understand the\n",(0,r.jsx)(n.a,{href:"/directory/docs/online-pki#ocsp-and-remote-crls",children:"pros and cons of doing so"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"verification-of-signed-data",children:"Verification of Signed Data"}),"\n",(0,r.jsxs)(n.p,{children:["Any client can submit signed arguments, and DSAs with which Meerkat DSA\nassociates may return signed results or errors, provided that the operation\nitself permits such signed alternatives. If the\n",(0,r.jsx)(n.a,{href:"/directory/docs/env#meerkat_signing_disable_verification",children:(0,r.jsx)(n.code,{children:"MEERKAT_SIGNING_DISABLE_VERIFICATION"})}),"\nconfiguration option is enabled (set to ",(0,r.jsx)(n.code,{children:"1"}),"), these signature will NOT be\nverified, nor the presented certification path; otherwise, the presented\nsignature will be verified in accordance with\n",(0,r.jsx)(n.a,{href:"https://www.itu.int/rec/T-REC-X.509-201910-I/en",children:"ITU Recommendation X.509 (2019)"}),",\nSection 6, and the presented certification path will be verified in accordance\nwith\n",(0,r.jsx)(n.a,{href:"https://www.itu.int/rec/T-REC-X.509-201910-I/en",children:"ITU Recommendation X.509 (2019)"}),",\nSection 12."]}),"\n",(0,r.jsxs)(n.p,{children:["The certification path verification procedures are almost identical--if not\nactually identical--to those described in\n",(0,r.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc5280.html",children:"IETF RFC 5280"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"authorization-for-signed-results-and-errors",children:"Authorization for Signed Results and Errors"}),"\n",(0,r.jsxs)(n.p,{children:["Production of digital signatures can be computationally expensive, especially\nif a DSA is getting overwhelmed by a large number of requests, which means that\nthe production of signed results and errors can be a vector of attack for\nhackers looking to intentionally overwhelm your DSA to make it unusable\n(a ",(0,r.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Denial-of-service_attack",children:"denial-of-service attack"}),")."]}),"\n",(0,r.jsxs)(n.p,{children:["Also, the cryptographic entropy that can be used in the production of digital\nsignatures\n",(0,r.jsx)(n.a,{href:"https://superuser.com/questions/944510/why-am-i-constantly-running-out-of-entropy",children:"can be exhausted"}),",\nand, to the extent that results can be controlled by a user, they can be vectors\nfor ",(0,r.jsx)(n.a,{href:"https://www.crypto-it.net/eng/attacks/chosen-plaintext.html",children:"chosen plaintext attacks"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["For this reason, it may be desirable to limit who can receive signed results and\nerrors. Meerkat DSA allows you to define a minimum threshold for authentication\nthat a user must achieve to receive signed results or errors. Note that, in\naddition to meeting this level of authentication, this user will also have to\n",(0,r.jsx)(n.em,{children:"request"})," signed results or errors: X.500 directory systems are not supposed to\nreturn signed results or errors unless they are requested. How signed results\nor errors are requested is discussed later."]}),"\n",(0,r.jsxs)(n.p,{children:["Meerkat DSA also allows you to define a different threshold of authentication\njust for receiving signed errors. This may differ from the threshold for\nreceiving signed results. If not explicitly configured, this threshold will be\nthe same as it is for receiving signed results. It may be desirable to configure\na more stringent threshold of authentication for receiving signed errors than\nsigned results, since a ",(0,r.jsx)(n.em,{children:"result"})," generally means that something went well, as\nopposed to an error. The presence of a lot of errors may indicate a hacking\nattempt, and we don't want to waste precious resources doing favors for hackers,\ndo we?"]}),"\n",(0,r.jsx)(n.p,{children:"The overall authentication requirements for receiving signed results and errors\ncomes from these environment variables:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/directory/docs/env#meerkat_signing_min_auth_level",children:(0,r.jsx)(n.code,{children:"MEERKAT_SIGNING_MIN_AUTH_LEVEL"})})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/directory/docs/env#meerkat_signing_min_auth_local_qualifier",children:(0,r.jsx)(n.code,{children:"MEERKAT_SIGNING_MIN_AUTH_LOCAL_QUALIFIER"})})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/directory/docs/env#meerkat_signing_min_auth_signed",children:(0,r.jsx)(n.code,{children:"MEERKAT_SIGNING_MIN_AUTH_SIGNED"})})}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["These variables correspond to values of the ",(0,r.jsx)(n.code,{children:"AuthenticationLevel"})," data\nstructure defined in\n",(0,r.jsx)(n.a,{href:"https://www.itu.int/rec/T-REC-X.501/en",children:"ITU Recommendation X.501 (2019)"}),",\nSection 18.4.2.3, which is depicted below:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-asn1",children:"\nAuthenticationLevel ::= CHOICE {\n  basicLevels     SEQUENCE {\n    level           ENUMERATED {none(0), simple(1), strong(2),...},\n    localQualifier  INTEGER OPTIONAL,\n    signed          BOOLEAN DEFAULT FALSE,\n    ...},\n  other           EXTERNAL,\n  ... }\n\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Meerkat internally tracks each client's authentication level as a value of the\n",(0,r.jsx)(n.code,{children:"basicLevels"})," alternative shown above. The environment variables shown above\nare used to populate an ",(0,r.jsx)(n.code,{children:"AuthenticationLevel"})," to which the client's\n",(0,r.jsx)(n.code,{children:"AuthenticationLevel"})," is compared to determine whether they are permitted to\nreceive signed results or errors. You can tell what component of\n",(0,r.jsx)(n.code,{children:"AuthenticationLevel.basicLevels"})," each environment variable determines by their\nnames."]}),"\n",(0,r.jsxs)(n.p,{children:["For example, this set of configuration options will require that, to receive\nauthenticated results or errors, a given user must have authenticated with\n",(0,r.jsx)(n.em,{children:"at least"})," a password (if not something stronger, such as strong\nauthentication), and they MUST be using TLSv1.3 (or higher), and they MUST have\nsigned their argument:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"MEERKAT_LOCAL_QUALIFIER_POINTS_FOR_USING_TLS_1_3=128\nMEERKAT_SIGNING_MIN_AUTH_LEVEL=1\nMEERKAT_SIGNING_MIN_AUTH_LOCAL_QUALIFIER=128\nMEERKAT_SIGNING_MIN_AUTH_SIGNED=1\n"})}),"\n",(0,r.jsxs)(n.p,{children:["By authenticating with a password (rather than anonymously or with no\ncredentials), a user will have an authentication level of 1. By using TLSv1.3 or\nhigher, the user will receive 128 ",(0,r.jsx)(n.code,{children:"localQualifier"})," points from this DSA, which\nmeans that this user meets the threshold of ",(0,r.jsx)(n.code,{children:"localQualifier"}),' "points." By\nsigning the argument, the user meets the signing requirement as well.']}),"\n",(0,r.jsx)(n.p,{children:"You may want a different authentication level requirement for receiving signed\nerrors. You can do so by modifying these environment variables, which follow the\nsame semantics. These environment variables override the authentication level\nrequired for receiving signed results, if they are specified:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/directory/docs/env#meerkat_signing_errors_min_auth_level",children:(0,r.jsx)(n.code,{children:"MEERKAT_SIGNING_ERRORS_MIN_AUTH_LEVEL"})})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/directory/docs/env#meerkat_signing_errors_min_auth_local_qualifier",children:(0,r.jsx)(n.code,{children:"MEERKAT_SIGNING_ERRORS_MIN_AUTH_LOCAL_QUALIFIER"})})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/directory/docs/env#meerkat_signing_errors_min_auth_signed",children:(0,r.jsx)(n.code,{children:"MEERKAT_SIGNING_ERRORS_MIN_AUTH_SIGNED"})})}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"how-to-request-signed-results-or-errors",children:"How to Request Signed Results or Errors"}),"\n",(0,r.jsxs)(n.p,{children:["For all DAP operations, with the exception of the ",(0,r.jsx)(n.code,{children:"abandon"}),", ",(0,r.jsx)(n.code,{children:"changePassword"}),",\nand ",(0,r.jsx)(n.code,{children:"administerPassword"})," operations, set the ",(0,r.jsx)(n.code,{children:"securityParameters.target"}),"\nproperty to ",(0,r.jsx)(n.code,{children:"signed"})," (value 1) to request signed results; set\n",(0,r.jsx)(n.code,{children:"securityParameters.errorProtection"})," to ",(0,r.jsx)(n.code,{children:"signed"})," (value 1) to request signed\nerrors."]}),"\n",(0,r.jsx)(n.admonition,{type:"info",children:(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"abandon"}),", ",(0,r.jsx)(n.code,{children:"changePassword"}),", and ",(0,r.jsx)(n.code,{children:"administerPassword"})," operations do not have\n",(0,r.jsx)(n.code,{children:"securityParameters"}),", which is why signing cannot be requested with these\noperations."]})}),"\n",(0,r.jsx)(n.h2,{id:"how-signing-affects-pagination-and-chaining",children:"How Signing Affects Pagination and Chaining"}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["This section only applies to ",(0,r.jsx)(n.code,{children:"list"})," and ",(0,r.jsx)(n.code,{children:"search"})," operations."]})}),"\n",(0,r.jsx)(n.p,{children:"In Meerkat DSA, signing cannot be used with pagination and chaining. Pagination\nand chaining, together, mean that the results may contain digital signatures\nproduced by other DSAs that were produced over results returned by other DSAs."}),"\n",(0,r.jsx)(n.p,{children:"There is no way to break these results into pages, nor sorting them, while\nretaining their digital signatures obtained from other DSAs; do so invalidates\nthe signatures. Therefore, signing and pagination are fundamentally at odds with\none another."}),"\n",(0,r.jsxs)(n.admonition,{type:"info",children:[(0,r.jsx)(n.p,{children:"Rationale for this behavior:"}),(0,r.jsx)(n.p,{children:"Since the search and list results might be important, and since the expected\nbehavior in this case is not well-defined, Meerkat DSA will not\ninvalidate the digital signatures to provide the chained and paginated results,\nand will simply return an error when these conflicting options are chosen."})]}),"\n",(0,r.jsx)(n.h2,{id:"signing-of-bind-results",children:"Signing of Bind Results"}),"\n",(0,r.jsxs)(n.p,{children:["According to\n",(0,r.jsx)(n.a,{href:"https://www.itu.int/rec/T-REC-X.511/en",children:"ITU Recommendation X.511 (2019)"}),",\nSection 9.1.4, Bind errors can be signed if strong authentication or SPKM\nauthentication are used. Otherwise, Meerkat DSA will not sign bind errors or\nresults."]}),"\n",(0,r.jsx)(n.h2,{id:"implementation",children:"Implementation"}),"\n",(0,r.jsxs)(n.p,{children:["Meerkat DSA has its own implementation of certificate path validation that is\nindependent of OpenSSL (out of necessity). This implementation has been tested\nagainst the\n",(0,r.jsx)(n.a,{href:"https://csrc.nist.gov/csrc/media/projects/pki-testing/documents/pkits.pdf",children:"NIST PKITS"}),",\nexcluding tests that relate to CRLs (both local and remote) and OCSP."]}),"\n",(0,r.jsx)(n.p,{children:"CRLs (both local and remote) and OCSP are believed to work, but have not been\ntested thoroughly."})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}}}]);