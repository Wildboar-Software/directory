<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-tutorial02" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Tutorial 2: Hooking up Gitea with Meerkat DSA | Meerkat DSA</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://wildboar-software.github.io/directory/docs/tutorial02"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="directory, x500, x.500, ldap, database, meerkat, dsa, distributed"><meta data-rh="true" name="copyright" content="Copyright (c) 2021-2025 Jonathan M. Wilbur &lt;jonathan@wilbur.space&gt;."><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Tutorial 2: Hooking up Gitea with Meerkat DSA | Meerkat DSA"><meta data-rh="true" name="description" content="In this tutorial, we will configure a Gitea server to use"><meta data-rh="true" property="og:description" content="In this tutorial, we will configure a Gitea server to use"><link data-rh="true" rel="icon" href="/directory/img/boar-head-rune-circle.svg"><link data-rh="true" rel="canonical" href="https://wildboar-software.github.io/directory/docs/tutorial02"><link data-rh="true" rel="alternate" href="https://wildboar-software.github.io/directory/docs/tutorial02" hreflang="en"><link data-rh="true" rel="alternate" href="https://wildboar-software.github.io/directory/docs/tutorial02" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Tutorial 2: Hooking up Gitea with Meerkat DSA","item":"https://wildboar-software.github.io/directory/docs/tutorial02"}]}</script><link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-177382419-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>



<link rel="icon" href="/directory/img/boar-head-rune-circle.svg">
<link rel="manifest" href="/directory/manifest.json">
<meta name="theme-color" content="rgb(37, 194, 160)"><link rel="stylesheet" href="/directory/assets/css/styles.3a3d7962.css">
<script src="/directory/assets/js/runtime~main.7d85a640.js" defer="defer"></script>
<script src="/directory/assets/js/main.3056611a.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"dark"),document.documentElement.setAttribute("data-theme-choice",t||"dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/directory/img/boar-head-rune-circle-black.svg"><link rel="preload" as="image" href="/directory/img/boar-head-rune-circle.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_G6ar" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/directory/"><div class="navbar__logo"><img src="/directory/img/boar-head-rune-circle-black.svg" alt="Wildboar Software Logo" class="themedComponent_DHUr themedComponent--light_DIHH"><img src="/directory/img/boar-head-rune-circle.svg" alt="Wildboar Software Logo" class="themedComponent_DHUr themedComponent--dark_Bv2M"></div><b class="navbar__title text--truncate">Meerkat DSA</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/directory/docs/setup">Get Started</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/directory/docs/docs">Documentation</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/directory/docs/specs">X.500 Specifications</a><a class="navbar__item navbar__link" href="/directory/docs/demo">Demo</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/Wildboar-Software/directory" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_OLSw colorModeToggle_Hg9V"><button class="clean-btn toggleButton_wYmb toggleButtonDisabled_vaDU" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_KEbZ lightToggleIcon_Sxwe"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_KEbZ darkToggleIcon_Yem1"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_KEbZ systemToggleIcon_txm5"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_bmvg"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_UyTV"><div class="docsWrapper_XLvK"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_z1FD" type="button"></button><div class="docRoot_HciC"><aside class="theme-doc-sidebar-container docSidebarContainer_e5ai"><div class="sidebarViewport_N8x0"><div class="sidebar_vJCc"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_qiME"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/directory/docs/docs"><span title="How to use this documentation" class="linkLabel_PuAu">How to use this documentation</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/directory/docs/intro"><span title="X.500" class="categoryLinkLabel_Oe72">X.500</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/directory/docs/setup"><span title="Meerkat DSA" class="categoryLinkLabel_Oe72">Meerkat DSA</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/directory/docs/x500cli"><span title="Clients and Libraries" class="categoryLinkLabel_Oe72">Clients and Libraries</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/directory/docs/tutorial01"><span title="Tutorials" class="categoryLinkLabel_Oe72">Tutorials</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/tutorial01"><span title="Tutorial 1: Set up the X.500 CLI" class="linkLabel_PuAu">Tutorial 1: Set up the X.500 CLI</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/directory/docs/tutorial02"><span title="Tutorial 2: Hooking up Gitea with Meerkat DSA" class="linkLabel_PuAu">Tutorial 2: Hooking up Gitea with Meerkat DSA</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/tutorial03"><span title="Tutorial 3: Add NHOBs and Subordinates" class="linkLabel_PuAu">Tutorial 3: Add NHOBs and Subordinates</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/directory/docs/asn1"><span title="Reference" class="categoryLinkLabel_Oe72">Reference</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/directory/docs/changelog-meerkat"><span title="Change Logs" class="categoryLinkLabel_Oe72">Change Logs</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/directory/docs/versioning"><span title="For Developers" class="categoryLinkLabel_Oe72">For Developers</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/directory/docs/support"><span title="Support / Help" class="linkLabel_PuAu">Support / Help</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_namt"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_YAwJ"><div class="docItemContainer_Rv5Z"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_zCmv" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/directory/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_JFrk"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Tutorials</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Tutorial 2: Hooking up Gitea with Meerkat DSA</span></li></ul></nav><div class="tocCollapsible_O_Qc theme-doc-toc-mobile tocMobile_tjDr"><button type="button" class="clean-btn tocCollapsibleButton_htYj">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Tutorial 2: Hooking up Gitea with Meerkat DSA</h1></header>
<p>In this tutorial, we will configure a <a href="https://gitea.io/" target="_blank" rel="noopener noreferrer" class="">Gitea</a> server to use
Meerkat DSA as a source of authentication. After this tutorial, you will be
able to add users to a Meerkat DSA instance and have them gain access to a
Gitea server automatically. These users will be members of a fictitious
organization named Foobar, Inc.</p>
<p>Gitea was chosen for this tutorial because it is one of the easiest applications
to start up with almost no configuration. In fact, merely installing it via the
<a href="https://gitea.com/gitea/helm-chart/" target="_blank" rel="noopener noreferrer" class="">Helm chart</a> with no modified settings is
sufficient for this tutorial.</p>
<p>This tutorial will assume that you have a Meerkat DSA instance already started,
but there is no data other than the Root DSE (which is created automatically if
it is not found).</p>
<p>This tutorial will also assume that you have installed and configured the
<a class="" href="/directory/docs/x500cli">X.500 command-line interface</a> to connect anonymously to your DSA.</p>
<h2 class="anchor anchorTargetStickyNavbar_SAay" id="how-it-works">How It Works<a href="#how-it-works" class="hash-link" aria-label="Direct link to How It Works" title="Direct link to How It Works" translate="no">​</a></h2>
<p>Gitea, as well as many other programs, support LDAP as a source of user
information. Rather than storing user names and passwords in a program&#x27;s
database, a lot of applications can wire up to an LDAP server to fetch
information about users, groups, roles, permissions, etc. Unfortunately, DAP
is not widely supported, but we are going to change that; for now, you have to
use LDAP. Still, for the sake of this tutorial, we can use DAP commands to set
up Meerkat DSA, then we will configure Gitea to access our Meerkat DSA instance
via LDAP to authenticate users.</p>
<h2 class="anchor anchorTargetStickyNavbar_SAay" id="creating-the-organizations-dse">Creating the Organization&#x27;s DSE<a href="#creating-the-organizations-dse" class="hash-link" aria-label="Direct link to Creating the Organization&#x27;s DSE" title="Direct link to Creating the Organization&#x27;s DSE" translate="no">​</a></h2>
<p>Create an organization first-level DSE using the following command:</p>
<div class="language-bash codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-bash codeBlock_TAPP thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#F8F8F2"><span class="token plain">x500 dap add org &#x27;o=Foobar&#x27; --organizationName=&#x27;Foobar&#x27;</span><br></span></code></pre></div></div>
<p>We are also going to set the password for the organization, because we will
consider this DSE to be the administrative user for the organization. It will
have supreme permissions to read and write everything in the organization.</p>
<p>We <em>could</em> have done this
in the previous command using the <code>--userPassword</code> option, but this is less
secure, because this command might end up in your shell&#x27;s history, and the
password can be transmitted hashed if we use the <code>apw</code> command instead, which
means that we can set the password without the DSA ever even knowing what it is.
To do so, run this command:</p>
<div class="language-bash codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-bash codeBlock_TAPP thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#F8F8F2"><span class="token plain">x500 dap apw &#x27;o=Foobar&#x27;</span><br></span></code></pre></div></div>
<p>Note that, because we defined our first password in this DSA, no users will be
able to add top-level DSEs except this first one.</p>
<div class="theme-admonition theme-admonition-tip admonition_IZjC alert alert--success"><div class="admonitionHeading_uVvU"><span class="admonitionIcon_HiR3"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_bl22"><p>There is no defined, standard way to restrict who can add first-level DSEs, so
Meerkat DSA&#x27;s solution is to grant the first user with a password the ability to
add first-level DSEs. Prior to this first password&#x27;s existence, any user can add
new first-level DSEs. For this reason, it is important to create a user with a
password as soon as you have your first-level DSEs created. For clarification,
this special privilege is only for adding first-level DSEs; outside of adding
these entries, normal access controls apply.</p></div></div>
<h2 class="anchor anchorTargetStickyNavbar_SAay" id="configure-access-control">Configure Access Control<a href="#configure-access-control" class="hash-link" aria-label="Direct link to Configure Access Control" title="Direct link to Configure Access Control" translate="no">​</a></h2>
<p>First we need to create an access control subentry. Its subtree specification
will cover the whole administrative area, which makes our command a lot
simpler.</p>
<div class="language-bash codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-bash codeBlock_TAPP thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#F8F8F2"><span class="token plain">x500 dap add subentry &#x27;o=Foobar,cn=Access Control&#x27; --commonName=&#x27;Access Control&#x27;</span><br></span></code></pre></div></div>
<p>Now, we want this subentry to become an access control subentry, so run this
command:</p>
<div class="language-bash codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-bash codeBlock_TAPP thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#F8F8F2"><span class="token plain">x500 dap mod become acsub &#x27;o=Foobar,cn=Access Control&#x27;</span><br></span></code></pre></div></div>
<p>Unfortunately, our next command is not simple at all. We have to define
Access Control Information (ACI) items, which define our access control rules.
The first one we should add establishes that the organization user (the
administrator) can do anything within the organzation.</p>
<div class="language-bash codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-bash codeBlock_TAPP thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#F8F8F2"><span class="token plain">x500 dap mod add aci &#x27;o=Foobar,cn=Access Control&#x27; prescriptive &#x27;Organization administrator&#x27; 250 simple \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --userName=&#x27;o=Foobar&#x27; \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --entry \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --allUserAttributeTypesAndValues \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --allOperationalAttributeTypesAndValues \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --grantAdd \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --grantDiscloseOnError \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --grantRead \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --grantRemove \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --grantBrowse \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --grantExport \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --grantImport \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --grantModify \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --grantRename \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --grantReturnDN \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --grantCompare \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --grantFilterMatch \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --grantInvoke</span><br></span></code></pre></div></div>
<p>The above command creates a prescriptive ACI item with the tag
&quot;Organization administrator&quot; and a precedence of 250 (pretty high, ensuring that
the administrator will always have administrative access) and <code>simple</code>
authentication level. The <code>userName</code> parameter specifically names <code>o=Foobar</code> as
the subject of this ACI item. The <code>entry</code> and <code>allUserAttributeTypesAndValues</code>
options name entries themselves and all of their attribute types and values as
the objects of this ACI item. Finally, we use every single <code>--grant*</code> option to
permit the subject every permissions to the objects.</p>
<p>In X.500 directories, subentries are controlled separately by subentry ACI
items, which are stored in their respective administrative points. We need to
create a separate ACI item for this so we can read and write to our subentry!</p>
<div class="language-bash codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-bash codeBlock_TAPP thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#F8F8F2"><span class="token plain">x500 dap mod add aci &#x27;o=Foobar&#x27; subentry &#x27;Organization administrator&#x27; 250 simple \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --userName=&#x27;o=Foobar&#x27; \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --entry \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --allUserAttributeTypesAndValues \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --allOperationalAttributeTypesAndValues \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --grantAdd \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --grantDiscloseOnError \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --grantRead \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --grantRemove \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --grantBrowse \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --grantExport \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --grantImport \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --grantModify \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --grantRename \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --grantReturnDN \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --grantCompare \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --grantFilterMatch \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --grantInvoke</span><br></span></code></pre></div></div>
<p>Note that the above command is <em>almost</em> the exact same as the one that came
before it. We just changed <code>prescriptive</code> to <code>subentry</code> and we changed the
target object to <code>o=Foobar</code>. The idea is still the same: we are granting
<code>o=Foobar</code> all permission to do everything to all subentries within this
access control administrative area.</p>
<p>For now, we only need these two ACI items. In a real directory, you will
probably want to define many more before you &quot;flip the switch&quot; to turn on access
controls. We are going to turn on access controls now, using the following
commands:</p>
<div class="language-bash codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-bash codeBlock_TAPP thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#F8F8F2"><span class="token plain">x500 dap mod become admpoint &#x27;o=Foobar&#x27; -z -a -u</span><br></span></code></pre></div></div>
<p>The <code>-z</code> option will make this administrative point an autonomous administrative
point. (It should already be autonomous, though. The X.500 specifications
require that all first-level DSEs are autonomous administrative points, so
Meerkat DSA automatically adds the autonomous administrative role to first-level
DSEs created without an <code>administrativeRole</code> attribute.) The <code>-a</code> option will
make this an access control administrative point for an Access Control Specific
Area (ACSA). The <code>-u</code> option will make this a subschema administrative area,
which will be useful shortly.</p>
<p>Finally, there is one more step to turn on access controls: add an access
control scheme attribute to the administrative point by using this command:</p>
<div class="language-bash codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-bash codeBlock_TAPP thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#F8F8F2"><span class="token plain">x500 dap mod add acs &#x27;o=Foobar&#x27; 2.5.28.1</span><br></span></code></pre></div></div>
<p>This adds an access control scheme of <code>2.5.28.1</code> to this administrative point,
which enables the Basic Access Control detailed in ITU Recommendation X.501.</p>
<div class="theme-admonition theme-admonition-info admonition_IZjC alert alert--info"><div class="admonitionHeading_uVvU"><span class="admonitionIcon_HiR3"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_bl22"><p>Because we enabled access controls, and we only defined ACI items for the
<code>o=Foobar</code> user, no other users will be able to do <em>anything</em> in this Access
Control Administrative Area (ACSA) unless the administrator, <code>o=Foobar</code> adds
more ACI items to allow it.</p></div></div>
<p>Because you enabled access controls, you will need to change your X.500
configuration file to authenticate as <code>o=Foobar</code> with a password instead of
anonymously. You will not be able to do anything otherwise.</p>
<h2 class="anchor anchorTargetStickyNavbar_SAay" id="creating-schema">Creating Schema<a href="#creating-schema" class="hash-link" aria-label="Direct link to Creating Schema" title="Direct link to Creating Schema" translate="no">​</a></h2>
<p>Just because you are logged in as a user whose access controls permit you to do
<em>anything</em> does not <em>really</em> mean that you can do anything. You are still
governed by schema rules, and since you did not define any DIT structure rules,
you cannot add any entries beneath <code>o=Foobar</code>, nor assign any auxiliary object
classes to any entries, nor use contexts, etc. Fortunately, <code>o=Foobar</code> has the
permissions needed to change this.</p>
<p>We are going to create a new subentry for the subschema.</p>
<div class="theme-admonition theme-admonition-info admonition_IZjC alert alert--info"><div class="admonitionHeading_uVvU"><span class="admonitionIcon_HiR3"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_bl22"><p>Technically, there is
no reason you could not use the access control subentry for this, but we named
this subentry &quot;Access Control,&quot; so it would be a misleading name if we also put
our subschema in there. Also, it is a requirement of the X.500 specifications
that subschema administrative areas apply to the whole area (e.g. the subtree
specification has to have 0 minimum, no maximum, no chops, no refinements, and
an empty base), which means that, if we changed or added a subtree to our access
control subentry, it would make our subschema non-compliant. (Technically,
Meerkat DSA just ignores the subtree specifications for subschema subentries, so
this shouldn&#x27;t be a problem for Meerkat DSA, but you don&#x27;t want to be
non-compliant, do you?)</p></div></div>
<p>Run the following command:</p>
<div class="language-bash codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-bash codeBlock_TAPP thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#F8F8F2"><span class="token plain">x500 dap add subentry &#x27;o=Foobar,cn=Subschema&#x27; --commonName=&#x27;Subschema&#x27;</span><br></span></code></pre></div></div>
<p>Now, we want to make this a subschema subentry, so run this command:</p>
<div class="language-bash codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-bash codeBlock_TAPP thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#F8F8F2"><span class="token plain">x500 dap mod become subschema &#x27;o=Foobar,cn=Subschema&#x27;</span><br></span></code></pre></div></div>
<p>Now, we can get to business. You could define your own name forms, but we are
just going to use the <code>orgNameForm</code> that comes installed in Meerkat DSA by
default, so we just need to define a DIT structure rule to use it. Run this
command to define a DIT structure rule that applies to the administrative point:</p>
<div class="language-bash codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-bash codeBlock_TAPP thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#F8F8F2"><span class="token plain">x500 dap mod add sr &#x27;o=Foobar,cn=Subschema&#x27; 1 2.5.15.3</span><br></span></code></pre></div></div>
<p>The command above defines a DIT structure rule with ID 1 that applies to an
administrative point with the name form identified by the object identifier
<code>2.5.15.3</code>. This object identifier is for <code>orgNameForm</code>. Since this name form
conforms to what we named our administrative point, and since this DIT structure
rule names no superior structure rules, this structure rule applies to the
administrative point <code>o=Foobar</code>, which will set the <em>governing structure rule</em>
for <code>o=Foobar</code>. Now that <code>o=Foobar</code> has a governing structure rule, you can
place other entries beneath it once you define other structure rules that permit
them.</p>
<p>Run this command to permit the creation of an <code>organizationalPerson</code> with the
name form <code>orgPersonNameForm</code> beneath <code>o=Foobar</code>:</p>
<div class="language-bash codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-bash codeBlock_TAPP thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#F8F8F2"><span class="token plain">x500 dap mod add sr &#x27;o=Foobar,cn=Subschema&#x27; 2 2.5.15.6 -s 1</span><br></span></code></pre></div></div>
<p>The above command will create a structure rule with an ID of 2. The object
identifier <code>2.5.15.6</code> is for <code>orgPersonNameForm</code>. The <code>-s 1</code> says that this
structure rule may permit entries under another entry whose governing structure
rule is 1 (which is our administrative point, <code>o=Foobar</code>, in this case).</p>
<p>That should be sufficient for our simple use case, but in a real DIT, you would
probably want to define many more structure rules, as well as content rules,
context use rules, matching rule uses, etc.</p>
<h2 class="anchor anchorTargetStickyNavbar_SAay" id="creating-users">Creating Users<a href="#creating-users" class="hash-link" aria-label="Direct link to Creating Users" title="Direct link to Creating Users" translate="no">​</a></h2>
<p>Now, we need to have a heart-to-heart: the schema specified in the X.500
specifications is not perfect. Notably, the schema for an organizational person
does not permit an email address, which is required by Gitea. Also, none of
these attributes are really suitable for storing a username. This means that
we are going to have to abuse these attributes&#x27; meanings and store email
addresses and usernames where they do not belong. Again, this is just a
tutorial, and you should define proper schema that does use the correct
attribute types.</p>
<div class="theme-admonition theme-admonition-info admonition_IZjC alert alert--info"><div class="admonitionHeading_uVvU"><span class="admonitionIcon_HiR3"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_bl22"><p>In the very near future, Meerkat DSA will introduce a LOT more pre-installed
schema, including the <code>inetOrgPerson</code> object class widely uses in LDAP servers.
This object class would be a great choice for this use case, if you can wait.</p></div></div>
<p>For our purposes, we are going to abuse the <code>commonName</code> attribute to store the
user&#x27;s username and the <code>title</code> attribute to store their email address.</p>
<p>Now we can create this troublesome organizational user by running this command:</p>
<div class="language-bash codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-bash codeBlock_TAPP thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#F8F8F2"><span class="token plain">x500 dap add op &#x27;o=Foobar,cn=cnorris&#x27; \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --commonName=&#x27;cnorris&#x27; \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --surname=&#x27;Norris&#x27; \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --title=&#x27;cnorris@gmail.com&#x27;</span><br></span></code></pre></div></div>
<p>If that command succeeded, we can now set the password for this user:</p>
<div class="language-bash codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-bash codeBlock_TAPP thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#F8F8F2"><span class="token plain">x500 dap apw &#x27;o=Foobar,cn=cnorris&#x27;</span><br></span></code></pre></div></div>
<p>And that&#x27;s it for the Meerkat DSA setup. Now we can configure Gitea to search
for users under <code>o=Foobar</code>!</p>
<h2 class="anchor anchorTargetStickyNavbar_SAay" id="gitea-configuration">Gitea Configuration<a href="#gitea-configuration" class="hash-link" aria-label="Direct link to Gitea Configuration" title="Direct link to Gitea Configuration" translate="no">​</a></h2>
<p>If you installed Gitea via the
<a href="https://gitea.com/gitea/helm-chart/" target="_blank" rel="noopener noreferrer" class="">Helm chart</a>, there should already be an
admin user, whose credentials can be found in the <code>values.yaml</code> file in the
linked repository (unless you overwrote them when you ran <code>helm</code>). Log in as
this user and click on the profile picture in the top right. Select
&quot;Site Administration&quot; from the dropdown. Open the &quot;Authentication Sources&quot; tab.
Click on &quot;Add Authentication Source.&quot;</p>
<p>In the Authentication Type dropdown, select &quot;LDAP (via BindDN).&quot; Give it a name,
and specify the hostname and port of your Meerkat DSA instance. Your Bind DN
should be <code>o=Foobar</code>. Your password should be the password you set for
<code>o=Foobar</code>. User search base should be <code>o=Foobar</code>.</p>
<p>Your search filter should be <code>(&amp;(objectClass=organizationalPerson)(cn=%s))</code>.
The <code>%s</code> gets replaced with the username, so if you type in <code>cnorris</code> on the
login page, Gitea will search for an entry with object class
<code>organizationalPerson</code> and with a common name of <code>cnorris</code>.</p>
<p>For the other settings:</p>
<ul>
<li class="">Username Attribute: <code>cn</code></li>
<li class="">First Name Attribute: <code>cn</code></li>
<li class="">Surname Attribute: <code>sn</code></li>
<li class="">Email Attribute: <code>title</code></li>
</ul>
<p>Finally, at the bottom, check &quot;Fetch Attributes in Bind DN Context.&quot;</p>
<div class="theme-admonition theme-admonition-info admonition_IZjC alert alert--info"><div class="admonitionHeading_uVvU"><span class="admonitionIcon_HiR3"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_bl22"><p>I don&#x27;t fully understand what &quot;Fetch Attributes in Bind DN Context&quot; does (the
documentation on Gitea&#x27;s LDAP integration is a little sparse), but this is what
I think it does:</p><p>When you use &quot;LDAP (via BindDN)&quot; authentication, the username and password
supplied at the configuration page are used to perform a search against the LDAP
server (in this case, Meerkat DSA) for the existence of a user according to a
search filter, and if that user appears in the results, Gitea permits that login
as that user, but Gitea still has to query that user&#x27;s attributes to get their
name and email address. By default, Gitea will query the user&#x27;s entry with the
credentials given at the login page, but since we did not define any access
controls that allow <code>o=Foobar,cn=cnorris</code> to query his own entry, Gitea
unexpectedly fails to read the attributes it needs. Specifically, it receives a
<code>noSuchObject</code> error, because, technically, <code>o=Foobar,cn=cnorris</code> is not even
allowed to know about its own existence! However, when we check &quot;Fetch
Attributes in Bind DN Context,&quot; I believe it will use the Bind DN credentials to
query the object&#x27;s attributes, and <code>o=Foobar</code> <em>is</em> permitted to read this entry.</p></div></div>
<p>And that&#x27;s it! Save the authentication source and log in using the username
<code>cnorris</code> and the password you created in Meerkat DSA for this user. Congrats on
making it this far!</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_HJkF"><a href="https://github.com/Wildboar-Software/directory/edit/main/website/docs/tutorial02.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_UohW" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_g62E"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/directory/docs/tutorial01"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Tutorial 1: Set up the X.500 CLI</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/directory/docs/tutorial03"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Tutorial 3: Add NHOBs and Subordinates</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_TN1Q thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#how-it-works" class="table-of-contents__link toc-highlight">How It Works</a></li><li><a href="#creating-the-organizations-dse" class="table-of-contents__link toc-highlight">Creating the Organization&#39;s DSE</a></li><li><a href="#configure-access-control" class="table-of-contents__link toc-highlight">Configure Access Control</a></li><li><a href="#creating-schema" class="table-of-contents__link toc-highlight">Creating Schema</a></li><li><a href="#creating-users" class="table-of-contents__link toc-highlight">Creating Users</a></li><li><a href="#gitea-configuration" class="table-of-contents__link toc-highlight">Gitea Configuration</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022-2025 Wildboar Software. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>