<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-authentication" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Authentication | Meerkat DSA</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://wildboar-software.github.io/directory/docs/authentication"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="directory, x500, x.500, ldap, database, meerkat, dsa, distributed"><meta data-rh="true" name="copyright" content="Copyright (c) 2021-2025 Jonathan M. Wilbur &lt;jonathan@wilbur.space&gt;."><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Authentication | Meerkat DSA"><meta data-rh="true" name="description" content="Meerkat DSA supports simple authentication (meaning authentication with a"><meta data-rh="true" property="og:description" content="Meerkat DSA supports simple authentication (meaning authentication with a"><link data-rh="true" rel="icon" href="/directory/img/boar-head-rune-circle.svg"><link data-rh="true" rel="canonical" href="https://wildboar-software.github.io/directory/docs/authentication"><link data-rh="true" rel="alternate" href="https://wildboar-software.github.io/directory/docs/authentication" hreflang="en"><link data-rh="true" rel="alternate" href="https://wildboar-software.github.io/directory/docs/authentication" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Authentication","item":"https://wildboar-software.github.io/directory/docs/authentication"}]}</script><link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-177382419-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>



<link rel="icon" href="/directory/img/boar-head-rune-circle.svg">
<link rel="manifest" href="/directory/manifest.json">
<meta name="theme-color" content="rgb(37, 194, 160)"><link rel="stylesheet" href="/directory/assets/css/styles.3a3d7962.css">
<script src="/directory/assets/js/runtime~main.7d85a640.js" defer="defer"></script>
<script src="/directory/assets/js/main.b6a6187a.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"dark"),document.documentElement.setAttribute("data-theme-choice",t||"dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/directory/img/boar-head-rune-circle-black.svg"><link rel="preload" as="image" href="/directory/img/boar-head-rune-circle.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_G6ar" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/directory/"><div class="navbar__logo"><img src="/directory/img/boar-head-rune-circle-black.svg" alt="Wildboar Software Logo" class="themedComponent_DHUr themedComponent--light_DIHH"><img src="/directory/img/boar-head-rune-circle.svg" alt="Wildboar Software Logo" class="themedComponent_DHUr themedComponent--dark_Bv2M"></div><b class="navbar__title text--truncate">Meerkat DSA</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/directory/docs/setup">Get Started</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/directory/docs/docs">Documentation</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/directory/docs/specs">X.500 Specifications</a><a class="navbar__item navbar__link" href="/directory/docs/demo">Demo</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/Wildboar-Software/directory" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_OLSw colorModeToggle_Hg9V"><button class="clean-btn toggleButton_wYmb toggleButtonDisabled_vaDU" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_KEbZ lightToggleIcon_Sxwe"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_KEbZ darkToggleIcon_Yem1"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_KEbZ systemToggleIcon_txm5"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_bmvg"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_UyTV"><div class="docsWrapper_XLvK"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_z1FD" type="button"></button><div class="docRoot_HciC"><aside class="theme-doc-sidebar-container docSidebarContainer_e5ai"><div class="sidebarViewport_N8x0"><div class="sidebar_vJCc"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_qiME"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/directory/docs/docs"><span title="How to use this documentation" class="linkLabel_PuAu">How to use this documentation</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/directory/docs/intro"><span title="X.500" class="categoryLinkLabel_Oe72">X.500</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/directory/docs/setup"><span title="Meerkat DSA" class="categoryLinkLabel_Oe72">Meerkat DSA</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/setup"><span title="Setup" class="linkLabel_PuAu">Setup</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/env"><span title="Configuration" class="linkLabel_PuAu">Configuration</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/webadmin"><span title="The Web Admin Console" class="linkLabel_PuAu">The Web Admin Console</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/database"><span title="Database Administration" class="linkLabel_PuAu">Database Administration</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/authorization"><span title="Authorization" class="linkLabel_PuAu">Authorization</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/directory/docs/authentication"><span title="Authentication" class="linkLabel_PuAu">Authentication</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/logging-monitoring"><span title="Logging and Monitoring" class="linkLabel_PuAu">Logging and Monitoring</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/schema"><span title="Schema Administration" class="linkLabel_PuAu">Schema Administration</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/networking"><span title="Networking" class="linkLabel_PuAu">Networking</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/distributed"><span title="Distributed Operations" class="linkLabel_PuAu">Distributed Operations</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/tls"><span title="Transport Layer Security (TLS)" class="linkLabel_PuAu">Transport Layer Security (TLS)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/online-pki"><span title="Online PKI" class="linkLabel_PuAu">Online PKI</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/signing"><span title="Signed Operations" class="linkLabel_PuAu">Signed Operations</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/opbinding"><span title="Operational Bindings" class="linkLabel_PuAu">Operational Bindings</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/shadowing"><span title="Shadowing" class="linkLabel_PuAu">Shadowing</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/dynamic"><span title="Dynamic Entries" class="linkLabel_PuAu">Dynamic Entries</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/administration"><span title="Administration" class="linkLabel_PuAu">Administration</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/troubleshooting"><span title="Troubleshooting" class="linkLabel_PuAu">Troubleshooting</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/advice"><span title="Advice" class="linkLabel_PuAu">Advice</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/usage"><span title="Usage" class="linkLabel_PuAu">Usage</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/zonal"><span title="Zonal Matching" class="linkLabel_PuAu">Zonal Matching</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/attr-cert"><span title="Attribute Certificates" class="linkLabel_PuAu">Attribute Certificates</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/conformance"><span title="Conformance" class="linkLabel_PuAu">Conformance</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/deviations-nuances"><span title="Deviations and Nuances" class="linkLabel_PuAu">Deviations and Nuances</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/information-disclosure"><span title="Information Disclosure" class="linkLabel_PuAu">Information Disclosure</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/architecture"><span title="Architecture" class="linkLabel_PuAu">Architecture</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/roadmap"><span title="Roadmap" class="linkLabel_PuAu">Roadmap</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/directory/docs/x500cli"><span title="Clients and Libraries" class="categoryLinkLabel_Oe72">Clients and Libraries</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/directory/docs/tutorial01"><span title="Tutorials" class="categoryLinkLabel_Oe72">Tutorials</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/directory/docs/asn1"><span title="Reference" class="categoryLinkLabel_Oe72">Reference</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/directory/docs/changelog-meerkat"><span title="Change Logs" class="categoryLinkLabel_Oe72">Change Logs</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/directory/docs/versioning"><span title="For Developers" class="categoryLinkLabel_Oe72">For Developers</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/directory/docs/support"><span title="Support / Help" class="linkLabel_PuAu">Support / Help</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_namt"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_YAwJ"><div class="docItemContainer_Rv5Z"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_zCmv" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/directory/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_JFrk"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Meerkat DSA</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Authentication</span></li></ul></nav><div class="tocCollapsible_O_Qc theme-doc-toc-mobile tocMobile_tjDr"><button type="button" class="clean-btn tocCollapsibleButton_htYj">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Authentication</h1></header>
<p>Meerkat DSA supports simple authentication (meaning authentication with a
password) and strong authentication (meaning authentication with digital signatures)
in DAP, DSP, and DOP. LDAP only supports simple authentication.</p>
<h2 class="anchor anchorTargetStickyNavbar_SAay" id="anonymous-authentication">Anonymous Authentication<a href="#anonymous-authentication" class="hash-link" aria-label="Direct link to Anonymous Authentication" title="Direct link to Anonymous Authentication" translate="no">​</a></h2>
<p>Users of Meerkat DSA may bind anonymously by supplying no password. If this is
used, authentication will always succeed, even if the bound distinguished name
does not correspond to any real entry present and even if the entry <em>does</em> exist
and has a password. This behavior is to avoid information disclosure.</p>
<div class="theme-admonition theme-admonition-note admonition_IZjC alert alert--secondary"><div class="admonitionHeading_uVvU"><span class="admonitionIcon_HiR3"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_bl22"><p>If Meerkat DSA did not do this, it would be possible for a nefarious
actor to enumerate the entries in a DSA, despite access controls, by guessing
distinguished names in the bind operation and seeing which attempts come back
with errors saying &quot;entry does not exist&quot; and which come back with &quot;invalid
password.&quot; This is the same reason that websites with logins must give you the
same error message, regardless of whether you got the username or password
wrong.</p></div></div>
<p>When users are bound anonymously, they may perform operations against Meerkat
DSA. It is the responsibility of administrators to configure access controls to
prevent anonymous users from doing things they should not be able to do.</p>
<p>Currently, anonymous usage can only be prevented by access control, but a future
feature will enable administrators to reject all anonymous traffic.</p>
<h2 class="anchor anchorTargetStickyNavbar_SAay" id="how-meerkat-dsa-handles-passwords">How Meerkat DSA Handles Passwords<a href="#how-meerkat-dsa-handles-passwords" class="hash-link" aria-label="Direct link to How Meerkat DSA Handles Passwords" title="Direct link to How Meerkat DSA Handles Passwords" translate="no">​</a></h2>
<p>In the X.500 specifications, there is no specified attribute that is expected to
serve as the authoritative source of the password for an entry. Each DSA may
choose to use a different attribute type to store password information; in fact,
passwords might not even be stored in entries at all! This is why the
<code>administerPassword</code> and <code>changePassword</code> operations were introduced to the
Directory Access Protocol (DAP).</p>
<p>In Meerkat DSA, both the <code>userPassword</code> attribute (specified in
<a href="https://www.itu.int/rec/T-REC-X.509/en" target="_blank" rel="noopener noreferrer" class="">ITU Recommendation X.509</a>) and the
<code>userPwd</code> attribute (specified in
<a href="https://www.itu.int/rec/T-REC-X.520/en" target="_blank" rel="noopener noreferrer" class="">ITU Recommendation X.520</a>) are used.
However, regardless of any access controls, whenever these values are read, they
return empty strings. This is because passwords are extremely sensitive, and
let&#x27;s face it: people re-use passwords between services. To prevent
administrators from misconfiguring Meerkat DSA and leaking all of their users&#x27;
passwords, the passwords are simply never returned, even if queried directly,
and even if access controls permit it. An empty string is returned as the value
so that directory users can at least know <em>if</em> an entry has a password. In other
words, passwords are <em>write-only</em> in Meerkat DSA. This also applies to the
encrypted variants of passwords: they are never returned so that they can never
be used for
<a href="https://csrc.nist.gov/glossary/term/offline_attack" target="_blank" rel="noopener noreferrer" class="">offline password cracking</a>.</p>
<p>The password is stored in the database. If password is supplied using cleartext,
it will be salted and hashed using the Scrypt algorithm and stored in the
database. If the password is already encrypted / hashed, it will be stored using
the algorithm that was used to encrypt it.</p>
<h2 class="anchor anchorTargetStickyNavbar_SAay" id="simple-protected-passwords">Simple Protected Passwords<a href="#simple-protected-passwords" class="hash-link" aria-label="Direct link to Simple Protected Passwords" title="Direct link to Simple Protected Passwords" translate="no">​</a></h2>
<p>Simple authentication allows users to supply a <code>protected</code> password. Unlike the
<code>unprotected</code> and <code>userPwd</code> variants of the simple credentials password, this
variation can be protected against
<a href="https://en.wikipedia.org/wiki/Replay_attack" target="_blank" rel="noopener noreferrer" class="">replay attacks</a>, and it provides
a form of eavesdropping-mitigating encryption, even when TLS is not used to
secure the connection.</p>
<p>There is no specified algorithm for producing a <code>protected</code> password, although
<a href="https://www.itu.int/rec/T-REC-X.511/en" target="_blank" rel="noopener noreferrer" class="">ITU Recommendation X.511 (2019)</a>,
Annex E, provides a suggested algorith. Meerkat DSA deviates from this
algorithm slightly for security reasons. The entirety of the procedures used by
Meerkat DSA are documented <a class="" href="/directory/docs/deviations-nuances#protected-passwords">here</a>.</p>
<p>In short, to produce a protected password, a client must produce a DER-encoded
value of an ASN.1 value having the following type:</p>
<div class="language-asn1 codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-asn1 codeBlock_TAPP thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Meerkats-Actual-Hashable1 ::= SEQUENCE {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    name        DistinguishedName,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    time1       GeneralizedTime,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    random1     BIT STRING OPTIONAL,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    password    encrypted &lt; UserPwd -- This is an ASN.1 &quot;selection type.&quot; -- }</span><br></span></code></pre></div></div>
<p>In the above type, <code>name</code> is the distinguished name to which the user is
attempting to bind, <code>time1</code> is a time a few seconds into the future, <code>random1</code>
is a sequence of randomly-generated bits of any length (preferrably at least 64
bits), and <code>password</code> is the <code>UserPwd</code> construction of the user&#x27;s password,
which <em>must</em> use the <code>encrypted</code> alternative, and</p>
<div class="theme-admonition theme-admonition-tip admonition_IZjC alert alert--success"><div class="admonitionHeading_uVvU"><span class="admonitionIcon_HiR3"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_bl22"><p>It is strongly advised to use protected passwords whenever simple authentication
is used, since they are immune to replay attacks.</p></div></div>
<h2 class="anchor anchorTargetStickyNavbar_SAay" id="how-to-set-or-change-passwords">How to Set or Change Passwords<a href="#how-to-set-or-change-passwords" class="hash-link" aria-label="Direct link to How to Set or Change Passwords" title="Direct link to How to Set or Change Passwords" translate="no">​</a></h2>
<p>You may set or modify a password for an entry in four ways:</p>
<ul>
<li class="">At creation time, by including password attributes in the <code>addEntry</code> operation.</li>
<li class="">By modifying the entry via the <code>modifyEntry</code> operation.<!-- -->
<ul>
<li class="">If this is performed within a password administrative area, this requires
the <code>pwdModifyEntryAllowed</code> operational attribute for the applicable
subentry to have a value of <code>TRUE</code>.</li>
</ul>
</li>
<li class="">By modifying the entry via the <code>changePassword</code> operation<!-- -->
<ul>
<li class="">If this is performed within a password administrative area, this requires
the <code>pwdChangeAllowed</code> operational attribute for the applicable subentry to
have a value of <code>TRUE</code>.</li>
</ul>
</li>
<li class="">By modifying the entry via the <code>administerPassword</code> operation<!-- -->
<ul>
<li class="">In addition to requiring permission to add / modify / delete the <code>userPwd</code>
and <code>userPassword</code> values, as is the case for the other three, this option
also requires the same permissions for the <code>userPwdHistory</code> attribute.</li>
<li class="">Note that, when this operation is used, the user will have to reset his or
her password upon logging in again.</li>
</ul>
</li>
</ul>
<p>It is recommended to use the <code>administerPassword</code> and/or <code>changePassword</code>
operations to modify an entry&#x27;s password, rather than the <code>modifyEntry</code> or
<code>addEntry</code> operations.</p>
<h2 class="anchor anchorTargetStickyNavbar_SAay" id="password-policy">Password Policy<a href="#password-policy" class="hash-link" aria-label="Direct link to Password Policy" title="Direct link to Password Policy" translate="no">​</a></h2>
<p>Meerkat DSA allows you to configure password policy exactly as described in ITU
Recommendations X.501 and X.520.</p>
<h3 class="anchor anchorTargetStickyNavbar_SAay" id="password-dictionaries">Password Dictionaries<a href="#password-dictionaries" class="hash-link" aria-label="Direct link to Password Dictionaries" title="Direct link to Password Dictionaries" translate="no">​</a></h3>
<p>You can configure password vocabulary by adding entries to the
<code>passwordDictionaryItem</code> table in the SQLite database, along with a
&quot;bit number&quot; indicating the category in which the vocabulary item appears,
according to the syntax of the <code>pwdVocabulary</code> operational attribute, which is:</p>
<div class="language-asn1 codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-asn1 codeBlock_TAPP thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#F8F8F2"><span class="token plain">PwdVocabulary ::= BIT STRING {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  noDictionaryWords (0),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  noPersonNames (1),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  noGeographicalNames (2) }</span><br></span></code></pre></div></div>
<p>This means that, if you set the <code>bit</code> to <code>2</code>, the row that you create will be
considered a &quot;geographical name.&quot; <strong>Password dictionary items inserted into the
database MUST be upper-cased, or they will have no effect.</strong></p>
<p>There is no way to configure password dictionaries via DAP, currently. The
<code>pwdDictionaries</code> is purely informative and is not used by the directory in any
way.</p>
<div class="theme-admonition theme-admonition-tip admonition_IZjC alert alert--success"><div class="admonitionHeading_uVvU"><span class="admonitionIcon_HiR3"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_bl22"><p>It is recommended that you DO NOT use this operational attribute, as it goes
against modern guidance on password-based authentication. Namely, it is actually
recommended to construct passwords from four or more dictionary words, as such
passwords are more memorable, yet provide much more entropy than the
prior guidance of the &quot;8 characters minimum, at least one digit, at least one
symbol, etc.&quot; password.</p></div></div>
<h3 class="anchor anchorTargetStickyNavbar_SAay" id="password-lockouts">Password Lockouts<a href="#password-lockouts" class="hash-link" aria-label="Direct link to Password Lockouts" title="Direct link to Password Lockouts" translate="no">​</a></h3>
<p>Meerkat DSA fully supports password lockouts, as described in
<a href="https://www.itu.int/rec/T-REC-X.511/en" target="_blank" rel="noopener noreferrer" class="">ITU Recommendation X.511 (2019)</a>. This
means that administrators can configure their directories to &quot;lock out&quot; users
after so many failed authentication attempts.</p>
<p>To enable password lockouts, just set the <code>pwdMaxFailures</code> operational attribute
on the applicable password administration subentries. You can make the lockout
temporary using the <code>pwdLockoutDuration</code> operational attribute, if desired.</p>
<div class="theme-admonition theme-admonition-warning admonition_IZjC alert alert--warning"><div class="admonitionHeading_uVvU"><span class="admonitionIcon_HiR3"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_bl22"><p>Enabling password lockouts might not be a good idea. This feature can allow
nefarious users to purposefully guess wrong passwords for other users to lock
them out of their accounts. It may be a good idea to refrain from enabling this
unless you are having problems with brute-force attacks, and even then, the
<code>pwdLockoutDuration</code> should be set to a low value to ensure that accounts are
automatically unlocked after a short period of time.</p></div></div>
<h2 class="anchor anchorTargetStickyNavbar_SAay" id="strong-authentication">Strong Authentication<a href="#strong-authentication" class="hash-link" aria-label="Direct link to Strong Authentication" title="Direct link to Strong Authentication" translate="no">​</a></h2>
<p>Meerkat DSA supports strong authentication. If a certification path is supplied,
this is used to verify the signature and trustworthiness of the bind token
provided in strong authentication.</p>
<p>If a certification path is <em>not</em> supplied in the bind argument, but a name <em>is</em>
supplied (via the <code>name</code> parameter), and if the environment variable
<a class="" href="/directory/docs/env#meerkat_lookup_uncert_strong_auth"><code>MEERKAT_LOOKUP_UNCERT_STRONG_AUTH</code></a> is
set to <code>1</code> (enabled), Meerkat DSA searches internally for a user by the asserted
distinguished name; if this user is found, and it is of object class
<code>pkiCertPath</code>, and it has an attribute of type <code>pkiPath</code>, each value of its
<code>pkiPath</code> attribute is tried until a certification path is found that verifies
the bind token. If no such vindicating certification path is found, Meerkat DSA
rejects the authentication attempt. It is strongly preferred for clients to
supply a certification path in the bind argument so that this lookup need not
happen.</p>
<div class="theme-admonition theme-admonition-warning admonition_IZjC alert alert--warning"><div class="admonitionHeading_uVvU"><span class="admonitionIcon_HiR3"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_bl22"><p>Enabling the above feature is risky, since it can open your DSA up to
denial-of-service attacks. See more
<a class="" href="/directory/docs/env#meerkat_lookup_uncert_strong_auth">here</a>.</p></div></div>
<p>The certification path is verified with the trust anchors configured in
<a class="" href="/directory/docs/env#meerkat_signing_ca_file"><code>MEERKAT_SIGNING_CA_FILE</code></a>. If this environment
variable is not configured, the bundle of certificates that are built in to
the NodeJS runtime are used by default.</p>
<p>If <a class="" href="/directory/docs/env#meerkat_signing_disable_verification"><code>MEERKAT_SIGNING_DISABLE_VERIFICATION</code></a>
is enabled (meaning that all signature verification is disabled in Meerkat DSA),
strong authentication will always fail.</p>
<h2 class="anchor anchorTargetStickyNavbar_SAay" id="spkm-authentication">SPKM Authentication<a href="#spkm-authentication" class="hash-link" aria-label="Direct link to SPKM Authentication" title="Direct link to SPKM Authentication" translate="no">​</a></h2>
<p>Meerkat DSA supports SPKM Authentication, but does not use it when binding to
other DSAs. It is almost identical in functionality and security to strong
authentication, except that it is based on existing standards exterior to the
X.500 specifications. If you need high-security authentication, prefer the
<code>strong</code> mechanism over <code>spkm</code>.</p>
<h2 class="anchor anchorTargetStickyNavbar_SAay" id="external-authentication">External Authentication<a href="#external-authentication" class="hash-link" aria-label="Direct link to External Authentication" title="Direct link to External Authentication" translate="no">​</a></h2>
<p>Meerkat DSA supports the <code>externalProcedure</code> authentication mechanism described
in <a href="https://www.itu.int/rec/T-REC-X.511/en" target="_blank" rel="noopener noreferrer" class="">ITU Recommendation X.511 (2019)</a>.
This mechanism is an intentionally open-ended and extensible mechanism for
authentication. The parameter for an <code>externalProcedure</code> authentication is an
ASN.1 <code>EXTERNAL</code>.</p>
<p>Meerkat DSA only uses an <code>EXTERNAL</code> value that uses the <code>syntax</code> alternative of
the <code>identification</code> field. When encoded according to the encoding rules
detailed in ITU Recommendation X.690, such as the Basic Encoding Rules, this
field is referred to as the <code>direct-reference</code> field. If the
<code>indirect-reference</code> field is supplied, or the <code>direct-reference</code> field is not
supplied in the encoded <code>EXTERNAL</code> value, Meerkat DSA will respond with an
&quot;authentication mechanism unsupported&quot; error.</p>
<p>The <code>syntax</code> field of the <code>EXTERNAL</code> (or <code>direct-reference</code> according to the
X.690 parlance) is used to transmit an object identifier that identifies the
external authentication mechanism. Meerkat DSA looks up the external
authentication procedure associated with that object identifier and calls a
function to execute that authentication mechanism. If the mechanism is
unrecognized or unsupported, Meerkat DSA will return an &quot;authentication
mechanism unsupported&quot; error.</p>
<div class="theme-admonition theme-admonition-info admonition_IZjC alert alert--info"><div class="admonitionHeading_uVvU"><span class="admonitionIcon_HiR3"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_bl22"><p>There are two reasons that the <code>presentation-context-id</code> is not recognized by
Meerkat DSA for the external authentication procedure parameter:</p><ol>
<li class="">It would be really complicated from a code standpoint to &quot;look up&quot; the
presentation contexts from the underlying protocol stack, especially when
that has been intentionally abstracted away from the Remote Operation
Service Element (ROSE).</li>
<li class="">Presentation contexts presented by the presentation layers are likely not
going to be used for the external authentication procedure because their
abstract syntaxes usually describe an application-layer protocol, not an
external procedure.</li>
</ol><p>If you don&#x27;t understand what this means, don&#x27;t worry about it.</p></div></div>
<h3 class="anchor anchorTargetStickyNavbar_SAay" id="tls-client-certificate-authentication">TLS Client Certificate Authentication<a href="#tls-client-certificate-authentication" class="hash-link" aria-label="Direct link to TLS Client Certificate Authentication" title="Direct link to TLS Client Certificate Authentication" translate="no">​</a></h3>
<p>Meerkat DSA comes with one <code>externalProcedure</code> authentication mechanism
built-in: TLS client certificate authentication. It&#x27;s parameter can be described
using the following ASN.1 syntax:</p>
<div class="language-asn1 codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-asn1 codeBlock_TAPP thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#F8F8F2"><span class="token plain">id-tlsClientCertAuth OBJECT IDENTIFIER ::= { 1 3 6 1 4 1 56490 5 401 1 }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tlsClientCertAuth ABSTRACT-SYNTAX ::= { NULL IDENTIFIED BY id-tlsClientCertAuth }</span><br></span></code></pre></div></div>
<p>In other words, if you send a bind request using an <code>externalProcedure</code>
credential having the <code>syntax</code> of <code>1.3.6.1.4.1.56490.5.401.1</code> and a <code>data-value</code>
of <code>NULL</code> (although this part is not validated or checked at all), Meerkat DSA
will use TLS Client Certificate Authentication.</p>
<p>This means that Meerkat DSA will determine the user&#x27;s distinguished name from
the <code>subject</code> field of the client certificate asserted via TLS, and consider the
user strongly-authenticated, assuming that the asserted certificate chain is
valid.</p>
<p>Note that, for this to be enabled, the client MUST connect over TLS, and Meerkat
DSA MUST be configured to request a client certificate by either:</p>
<ol>
<li class="">Setting <a class="" href="/directory/docs/env#meerkat_tls_request_cert"><code>MEERKAT_TLS_REQUEST_CERT</code></a> to <code>1</code>, or</li>
<li class="">Setting <a class="" href="/directory/docs/env#meerkat_tls_reject_unauthorized_clients"><code>MEERKAT_TLS_REJECT_UNAUTHORIZED_CLIENTS</code></a> to <code>1</code></li>
</ol>
<p>(Of course, the client, must also actually <em>send</em> the client certificate. That
is implied.)</p>
<h3 class="anchor anchorTargetStickyNavbar_SAay" id="custom-external-authentication-procedures">Custom External Authentication Procedures<a href="#custom-external-authentication-procedures" class="hash-link" aria-label="Direct link to Custom External Authentication Procedures" title="Direct link to Custom External Authentication Procedures" translate="no">​</a></h3>
<p>You can add your own external authentication procedures in the
<a class="" href="/directory/docs/env#meerkat_init_js">init script</a>. An external authentication procedure
function has a signature like so:</p>
<div class="language-typescript codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-typescript codeBlock_TAPP thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">type</span><span class="token plain"> </span><span class="token class-name">ExternalAuthFunction</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ctx</span><span class="token operator">:</span><span class="token plain"> Context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// The context object</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    socket</span><span class="token operator">:</span><span class="token plain"> Socket </span><span class="token operator">|</span><span class="token plain"> TLSSocket</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// The TCP or TLS socket underlying the association with the client.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ext</span><span class="token operator">:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(189, 147, 249)">EXTERNAL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// The EXTERNAL that is the parameter of the `externalProcedure` credential.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// Set to DirectoryBindError for DAP, and DSABindError otherwise.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    BindErrorClass</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">typeof</span><span class="token plain"> DirectoryBindError</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">typeof</span><span class="token plain"> DSABindError</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">Promise</span><span class="token operator">&lt;</span><span class="token plain">BindReturn</span><span class="token operator">&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// This is what is returned from such a function.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">interface</span><span class="token plain"> </span><span class="token class-name">BindReturn</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">     * The bound vertex, which will only be set if this DSA has the bound DSE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">     * locally.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">     *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">     * Defined in @wildboar/meerkat-types.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    boundVertex</span><span class="token operator">?</span><span class="token operator">:</span><span class="token plain"> Vertex</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">     * The bound distinguished name and optional unique identifier. The</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">     * distinguished name will be set even if the user provided no credentials</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">     * to prove that they were that entry. The unique identifier will be set if</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">     * a local DSE having the bound distinguished name can be found and it has</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">     * at least one `uniqueIdentifier` attribute value. The first</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">     * `uniqueIdentifier` attribute value will be used to populate this field,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">     * even though there may potentially be multiple such values.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">     *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">     * Defined in @wildboar/x500/src/lib/modules/SelectedAttributeTypes/NameAndOptionalUID.ta</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    boundNameAndUID</span><span class="token operator">?</span><span class="token operator">:</span><span class="token plain"> NameAndOptionalUID</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">     * The level of credibility with which the user claimed to be the bound</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">     * entry. Whether the user bound anonymously, with a password, or with a</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">     * asymmetric cryptography will be represented here.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">     *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">     * Defined in @wildboar/x500/src/lib/modules/BasicAccessControl/AuthenticationLevel.ta</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    authLevel</span><span class="token operator">:</span><span class="token plain"> AuthenticationLevel</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">     * Information about a user password to return in the bind response or</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">     * error.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">     *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">     * Defined in @wildboar/x500/src/lib/modules/DirectoryAbstractService/PwdResponseValue.ta</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    pwdResponse</span><span class="token operator">?</span><span class="token operator">:</span><span class="token plain"> PwdResponseValue</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">     * The clearances associated with this user.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">     *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">     * Defined in @wildboar/x500/src/lib/modules/EnhancedSecurity/Clearance.ta</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    clearances</span><span class="token operator">:</span><span class="token plain"> Clearance</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">     * The credentials for the DSA to return to the client to provide mutual</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">     * authentication.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">     *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">     * Defined in @wildboar/x500/src/lib/modules/DistributedOperations/DSACredentials.ta</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token doc-comment comment" style="color:rgb(98, 114, 164)">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    reverseCredentials</span><span class="token operator">?</span><span class="token operator">:</span><span class="token plain"> DSACredentials</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre></div></div>
<p>If you would like an example implementation, see
<a href="https://github.com/Wildboar-Software/directory/blob/master/apps/meerkat/src/app/authn/external/tls_client_auth.ts" target="_blank" rel="noopener noreferrer" class="">this function</a>,
which is the implementation of the TLS Client Certificate Authentication
mechanism described above.</p>
<p>Once you have your function defined, add it to Meerkat DSA&#x27;s internal index of
<code>externalProcedure</code> mechanisms in the init script like so:</p>
<div class="language-javascript codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-javascript codeBlock_TAPP thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(189, 147, 249)">YOUR_MECHANISM_OID_REPLACE_ME</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;1.2.3.4.5&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">async</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">init</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">// Here, we associate the mechanism ID with the function that does the verification.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">externalProcedureAuthFunctions</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">set</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token constant" style="color:rgb(189, 147, 249)">YOUR_MECHANISM_OID_REPLACE_ME</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> your_function</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">// This is just logging, just to show you that you can do this. :)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Added my own custom external authentication mechanism&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">export</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">default</span><span class="token plain"> init</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_SAay" id="architectural-details">Architectural Details<a href="#architectural-details" class="hash-link" aria-label="Direct link to Architectural Details" title="Direct link to Architectural Details" translate="no">​</a></h2>
<p>You might notice that it can take a few seconds to authenticate to Meerkat DSA.
This is no accident.</p>
<p>Authentication is protected against
<a href="https://ropesec.com/articles/timing-attacks/" target="_blank" rel="noopener noreferrer" class="">timing attacks</a> by response time
randomization and constant-time string comparison. (These two methods may seem
to contradict each other, and you&#x27;d be right to point that out; however, both
are used so that, if one does not work, the other will.) By default, Meerkat DSA
always waits one second, but potentially up to two seconds, before responding
with an authentication result. Response time randomization can be configured by administrators via the <code>MEERKAT_BIND_MIN_SLEEP_MS</code>
and <code>MEERKAT_BIND_SLEEP_RANGE_MS</code> environment variables.</p>
<p>Notably, Meerkat DSA does not sleep for a random amount of time, perform the
credential evaluation, then return a result; it performs a credential evaluation
then waits the remaining amount of time such that the randomly-selected sleep
time has passed. If the former methodology were used, nefarious actors could
still perform a timing attack by attempting authentication many times to see
which attempts take the longest response time on average.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_HJkF"><a href="https://github.com/Wildboar-Software/directory/edit/main/website/docs/authentication.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_UohW" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_g62E"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/directory/docs/authorization"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Authorization</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/directory/docs/logging-monitoring"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Logging and Monitoring</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_TN1Q thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#anonymous-authentication" class="table-of-contents__link toc-highlight">Anonymous Authentication</a></li><li><a href="#how-meerkat-dsa-handles-passwords" class="table-of-contents__link toc-highlight">How Meerkat DSA Handles Passwords</a></li><li><a href="#simple-protected-passwords" class="table-of-contents__link toc-highlight">Simple Protected Passwords</a></li><li><a href="#how-to-set-or-change-passwords" class="table-of-contents__link toc-highlight">How to Set or Change Passwords</a></li><li><a href="#password-policy" class="table-of-contents__link toc-highlight">Password Policy</a><ul><li><a href="#password-dictionaries" class="table-of-contents__link toc-highlight">Password Dictionaries</a></li><li><a href="#password-lockouts" class="table-of-contents__link toc-highlight">Password Lockouts</a></li></ul></li><li><a href="#strong-authentication" class="table-of-contents__link toc-highlight">Strong Authentication</a></li><li><a href="#spkm-authentication" class="table-of-contents__link toc-highlight">SPKM Authentication</a></li><li><a href="#external-authentication" class="table-of-contents__link toc-highlight">External Authentication</a><ul><li><a href="#tls-client-certificate-authentication" class="table-of-contents__link toc-highlight">TLS Client Certificate Authentication</a></li><li><a href="#custom-external-authentication-procedures" class="table-of-contents__link toc-highlight">Custom External Authentication Procedures</a></li></ul></li><li><a href="#architectural-details" class="table-of-contents__link toc-highlight">Architectural Details</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022-2025 Wildboar Software. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>