<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.13">
<link rel="icon" href="/directory/img/docusaurus.png">
<link rel="manifest" href="/directory/manifest.json">
<meta name="theme-color" content="rgb(37, 194, 160)"><title data-react-helmet="true">Deviations and Nuances | Meerkat DSA</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://docs.meerkat.wildboar.software/directory/docs/deviations-nuances"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" name="keywords" content="directory, x500, x.500, ldap, database, meerkat, dsa, distributed"><meta data-react-helmet="true" name="copyright" content="Copyright (c) 2021 Jonathan M. Wilbur &lt;jonathan@wilbur.space&gt;."><meta data-react-helmet="true" property="og:title" content="Deviations and Nuances | Meerkat DSA"><meta data-react-helmet="true" name="description" content="Meerkat DSA deviates from the X.500 specifications in a few ways, often due to"><meta data-react-helmet="true" property="og:description" content="Meerkat DSA deviates from the X.500 specifications in a few ways, often due to"><link data-react-helmet="true" rel="icon" href="/directory/img/boar-head-rune-circle.svg"><link data-react-helmet="true" rel="canonical" href="https://docs.meerkat.wildboar.software/directory/docs/deviations-nuances"><link data-react-helmet="true" rel="alternate" href="https://docs.meerkat.wildboar.software/directory/docs/deviations-nuances" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.meerkat.wildboar.software/directory/docs/deviations-nuances" hreflang="x-default"><link rel="stylesheet" href="/directory/assets/css/styles.e255e738.css">
<link rel="preload" href="/directory/assets/js/runtime~main.eb2a1aab.js" as="script">
<link rel="preload" href="/directory/assets/js/main.241135e7.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/directory/"><div class="navbar__logo"><img src="/directory/img/boar-head-rune-circle.svg" alt="Wildboar Software Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/directory/img/boar-head-rune-circle.svg" alt="Wildboar Software Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Meerkat DSA</b></a><a class="navbar__item navbar__link navbar__link--active" href="/directory/docs/setup">Get Started</a><a class="navbar__item navbar__link navbar__link--active" href="/directory/docs/docs">Documentation</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Wildboar-Software/directory" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleChecked_a04y toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" checked="" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/directory/docs/docs">How to use this documentation</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" href="/directory/docs/why-not-ldap">Meerkat DSA</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/why-not-ldap">Why Not LDAP?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/uses">Uses</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/setup">Setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/env">Environment Variables</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/database">Database Administration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/authorization">Authorization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/authentication">Authentication</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/logging-monitoring">Logging and Monitoring</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/schema">Schema Administration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/networking">Networking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/opbinding">Operational Bindings</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/administration">Administration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/advice">Advice</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/usage">Usage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/telemetry">Telemetry</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/conformance">Conformance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/directory/docs/deviations-nuances">Deviations and Nuances</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/information-disclosure">Information Disclosure</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/architecture">Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/roadmap">Roadmap</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/directory/docs/asn1">Reference</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/directory/docs/support">Support / Help</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Deviations and Nuances</h1></header><p>Meerkat DSA deviates from the X.500 specifications in a few ways, often due to
ambiguities in the specifications or creative leeway given by the
specifications to DSA implementors. These deviations are noted below. Also
noted below are nuances in Meerkat DSA:</p><ul><li>RFC 4512: &quot;The root DSE SHALL NOT be included if the client performs a subtree
search starting from the root.&quot; I could not find anywhere in the X.500
specifications where this behavior is required, however, it makes sense to me:
a search that does not explicitly target the root DSE should not include it,
because the root DSE is, in some sense, not a &quot;real&quot; entry in the DIT.</li><li>Meerkat will not allow the creation of attribute values from the modifyDN
operation. This is for security / integrity purposes.</li><li>Meerkat DSA automatically sets the
<code>SearchControlOptions.separateFamilyMembers</code> option when LDAP search requests
are converted to DAP search requests. This does not violate the X.500
standards, but it is not mentioned. In fact, there is no specified behavior on
how to translate an LDAP request into DAP--only the opposite.</li><li>Meerkat DSA will not throw a <code>noSuchAttributeOrValue</code> error during a compare
operation. That is insecure because it reveals that the entry does not have an
attribute of the asserted type.</li><li>The &quot;Target Not Found&quot; subprocedure defined in X.518 seems to imply that a
single CR must be chosen from candidateRefs to be added to the
NRContinuationList. Instead, Meerkat DSA adds all of them. Why not try all of
them?</li><li>Check Suitability of filter for a subtree search in a shadowed area is
extremely complicated and guaranteed to be incorrect. However, it will
function better when the attribute selection of replication and the filter is
simpler.</li><li>Check Suitability of selection for a search or read is not performed at all.
The selection will return whatever attributes are requested and replicated.</li><li>The X.500 specifications are not clear at all as to how the <code>uniqueIdentifier</code>
attribute is to be used for authentication, since it is multi-valued and
user-modifiable, so, during bind, the first <code>uniqueIdentifier</code>, if it exists,
will be used as the bound <code>NameAndOptionalUID</code>.</li><li>How LDAP matching rule assertion syntax is obtained from
MatchingRuleDescription: it is not. It is obtained from the
<code>ldapAssertionSyntax</code> property of matching rules.</li><li>Because LDAP schema values are converted to the equivalent X.500 types,
extensions (fields starting with &quot;X-&quot;) will be ignored and not preserved.</li><li>The <code>unmerged</code> parameter of paged results requests will be ignored for now.</li><li>ITU Recommendation X.511, Section 7.5.f is not clear in what it means by
&quot;behaves as though normal entries do not exist.&quot; The parent of a subentry is
necessarily a normal entry. Does this mean that a subtree search can only
return subentries immediately subordinate to the base object? Meerkat DSA
behaves as if this were so.</li><li><code>administrativeRole</code> is automatically added to top-level DSEs when added if it
is not present, making the entry an AAP.</li><li>The specification is not clear as to whether <code>pageNumber</code> is zero-indexed or
one-indexed. Meerkat DSA will treat this as zero-indexed. This means that,
whether the parameter is 0 or not supplied in the request, a simple falsy
check can inform the DSA as to whether it can ignore this parameter. If a user
did not want to use paging, they should omit this value, rather than setting
it to zero or one to indicate that they want the first page; for this reason,
1 will be treated as the &quot;second&quot; page. As another slight benefit, this also
means that if clients differ in their behavior from this, it means that
<em>fewer</em> entries will be returned.</li><li>Pagination may not be used when signing is required and chaining is not
prohibited. This is because there is no way to merge results while preserving
the signatures from other DSAs. If chaining is prohibited, there will only be
results from the local DSA, which mean that the results can be paginated and
signed.</li><li>There are necessarily no access controls that can be applied to first-level
DSEs that do not yet exist. This begs the question: how do we control which
users can add first-level DSEs? Meerkat DSA does this by prohibiting entries
that do not have a <code>may_add_top_level_dse</code> flag set. The first entry to have
a password set will automatically get this flag set as well. After that first
entry, any other entries that should have this permission will require
direct database queries to get this flag set. To use this privilege, a user
cannot be authenticated anonymously. This does not apply if there are no
users with passwords set, or if the <code>MEERKAT_OPEN_TOP_LEVEL</code> environment
variable is set to <code>1</code>.</li><li>When sorting is used in LDAP requests, the response will always indicate a
successful sort by including the sort response control with a success code. If
ever in the future, sorting status can &quot;trickle-up&quot; to the LDAP response from
the operation dispatcher, maybe this will change.</li><li><code>matchedValuesOnly</code> keeps only the matched values from all members of the
returned family. This might not be incorrect, since the X.500 specifications
do not clarify what the expected behavior is for non-contributing family
members, but it is something to be aware of.</li><li>The <code>restrictedBy</code> alternative of <code>ProtectedItems</code> is not supported for the
purposes of access control.</li><li>Pending implementation: it will be slightly more efficient to use the
user-first alternative for ACI Items, because the ACI Items can be
&quot;pre-filtered&quot; to only retain the relevant ones.</li><li><code>DiscloseOnError</code> permissions do not apply to some operations, such as list
and search when they return 0 results, or addEntry, because Meerkat DSA
requires the target objects to be discoverable in the first place.</li><li>We do not check for <code>DiscloseOnError</code> in modifyEntry and addEntry operations
that add values, to determine when an attribute value already exists before it
is added, because checks are already in place to determine if it can be added.
The X.500 specifications permit the attribute value&#x27;s existence to be
disclosed if DiscloseOnError OR Add permissions exist for that value, but
since Add permissions are a necessary pre-requisite before Meerkat DSA even
checks for duplicates, there is no need to worry about <code>DiscloseOnError</code>
permissions.</li><li>The ITU specs do not explicitly say that an IDM client cannot make multiple
subsequent bind attempts before the first one gets a response. If this is
allowed, it opens the doors to brute-force attempts. Nefarious users can
circumvent rate-limiting by submitting back-to-back bind requests without
waiting for each one to succeed sequentially. Meerkat DSA aborts IDM
connections with clients that attempt back-to-back binds.</li><li>ITU X.511 (2016), Page 43, Footnote 2: This is because, apparently, the ACI
for a subordinate reference may not be available locally (see ITU X.518
(2016), Section 19.3.1.2.1, item 3). If this is the case, the DSA <em>must</em> chain
to let the subordinate DSA decide whether to reveal this entry. There is not
really a good way to know if the subordinate DSA actually informed the
superior DSA of relevant access control information, so Meerkat DSA will
<em>assume</em> that it has all of the ACI information necessary to make this
decision. If the subordinate does not inform the superior of ACI information,
it is the fault of the subordinate if its <code>subr</code> entry is disclosed. For that
matter, the subordinate DSA could use no access control or an unsupported
access control scheme, for all the superior DSA knows.</li><li>The specification is not clear as to which member of search or list results,
including those within a compound entry or hierarchy selection, should have
<code>partialName</code> set to <code>TRUE</code> when a name is partially-resolved. Meerkat DSA
will only set <code>partialName</code> for the base object, unless
<code>separateFamilyMembers</code> is used, in which case all members of the family will
be marked accordingly.</li><li>Permission to read the entry and the attribute types and values of the new RDN
are required for renaming an entry. This prevents information disclosure where
a nefarious user could attempt to discover values present in the entry by
seeing which newRDN choices come back with a &quot;no such values&quot; error.</li><li>The X.500 specifications demand that, if a change or removal of a subschema or
DIT structural rule results in a change in the governing structural rule of
any entry in the subschema, every entry within the subtree beneath that entry
downwards until autonomous administrative points must have their governing
structure rules recalculated. Meerkat DSA does not update governing structure
rules automatically, because it could mean that potentially millions (or even
billions, depending on how big the directory gets!) of entries would be
affected. With Meerkat DSA, administrators must manually kick off a
recalculation of an entry&#x27;s governing structure rule. This can be done by
performing a modifyDN operation that &#x27;renames&#x27; an entry to its exact same name
on every entry, starting from the immediate subordinates of any affected entry
downwards until you reach autonomous administrative points or subschema
administrative points. Note that, whenever an entry is made into an autonomous
administrative point or subschema administrative point, or whenever such an
administrative point has a DIT structure rule added, removed, or modified in
its subschema, its governing structure rule will be automatically
recalculated; this does not recurse downward automatically.</li><li>When a subentry is added below an administrative point that is also a context
prefix, the superior DSA&#x27;s operational binding (if one exists) is updated.</li><li>The Root DSE may not be modified.</li><li>The information selection of a read or search operation is not evaluated against the
selection of information that is shadowed for a shadow DSE. Meerkat DSA
will simply return whatever it has.</li><li>When using the <code>removeValues</code> change from the <code>modifyEntry</code> operation, the
presence of the values to be removed will not be checked. Whether they exist
or not, this change will succeed. One benefit of this is that we do not have
to worry about accidentally disclosing to users which values exist and do not
exist for an entry by returning a different error when they do exist.</li><li>When using the <code>alterValues</code> change from the <code>modifyEntry</code> operation, <code>Modify</code>
permission is also required for the values that are to be replaced. This is
more strict than the specification.</li><li>Default context values are not used exactly as specified in X.501 (2016),
Section 13.9.2. If the context is required by context use rules, and if the
context of that type is not supplied, a default value can &quot;fill the gap,&quot; but
beyond that, default context values are not used. This is because the verbiage
of the section 13.9.2 is unclear.</li><li>ITU Recommendation X.501 (2016), Section 14.10 states that, when a
hierarchical parent is removed, its children are to be removed from <em>the</em>
hierarchical group. The specification does not make it clear whether they
should now belong to separate hierarchical groups with themselves at the top
or if we should recursively remove all hierarchical group attributes for all
hierarchical descendants. Meerkat DSA puts the children in their own separate
hierarchical groups. It is not clear whether this is a deviation from the
specification at all. This was chosen because it is the most performant,
easiest to implement, and preserves potentially a lot of work from accidental
deletion.</li><li>Meerkat DSA does not throw an error if a search or list operation returns a
null result (a result with zero entries or RDNs).</li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="the-never-contributing-bug">The &quot;Never Contributing&quot; Bug<a aria-hidden="true" class="hash-link" href="#the-never-contributing-bug" title="Direct link to heading">â€‹</a></h2><p>X.511 (2016), Section 7.13 states that:</p><blockquote><p>If the filter used is the default filter (and : { }), then all members of a
family grouping shall be marked as participating members, but not as
contributing members.</p></blockquote><p>This is a problem, because <code>familyReturn</code> defaults to <code>contributingEntriesOnly</code>,
which means that <em>nothing</em> will be returned even though the compound entry as a
whole matches <code>and:{}</code>. In other words, if the default search filter and
selection are used, compound entries will be entirely hidden from results if the
X.500 specifications are observed strictly.</p><p>This was probably not intentional, so I reported it. In early January of 2022.
Until I get clarification, Meerkat DSA will mark every entry as a contributing
member if there is a match, but no identified contributing members.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="other-deviations">Other Deviations<a aria-hidden="true" class="hash-link" href="#other-deviations" title="Direct link to heading">â€‹</a></h2><p>There are other deviations that haven&#x27;t been mentioned here. Most deviations
are the frequency of automated updates to operational bindings. Meerkat DSA
updates operational bindings more frequently than is required by the
specifications. This should not be of significance more the vast majority of
users, and is probably desirable.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/Wildboar-Software/directory/edit/main/website/docs/deviations-nuances.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/directory/docs/conformance"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« <!-- -->Conformance</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/directory/docs/information-disclosure"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Information Disclosure<!-- --> Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#the-never-contributing-bug" class="table-of-contents__link toc-highlight">The &quot;Never Contributing&quot; Bug</a></li><li><a href="#other-deviations" class="table-of-contents__link toc-highlight">Other Deviations</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/directory/docs/setup">Get Started</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Wildboar Software. Built with Docusaurus.</div></div></div></footer></div>
<script src="/directory/assets/js/runtime~main.eb2a1aab.js"></script>
<script src="/directory/assets/js/main.241135e7.js"></script>
</body>
</html>