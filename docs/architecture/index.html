<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.13">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-177382419-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="icon" href="/directory/img/boar-head-rune-circle.svg">
<link rel="manifest" href="/directory/manifest.json">
<meta name="theme-color" content="rgb(37, 194, 160)"><title data-react-helmet="true">Architecture | Meerkat DSA</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://docs.meerkat.wildboar.software/directory/docs/architecture"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" name="keywords" content="directory, x500, x.500, ldap, database, meerkat, dsa, distributed"><meta data-react-helmet="true" name="copyright" content="Copyright (c) 2021 Jonathan M. Wilbur &lt;jonathan@wilbur.space&gt;."><meta data-react-helmet="true" property="og:title" content="Architecture | Meerkat DSA"><meta data-react-helmet="true" name="description" content="Representation of the Distinguished Names in Persistent Storage"><meta data-react-helmet="true" property="og:description" content="Representation of the Distinguished Names in Persistent Storage"><link data-react-helmet="true" rel="icon" href="/directory/img/boar-head-rune-circle.svg"><link data-react-helmet="true" rel="canonical" href="https://docs.meerkat.wildboar.software/directory/docs/architecture"><link data-react-helmet="true" rel="alternate" href="https://docs.meerkat.wildboar.software/directory/docs/architecture" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.meerkat.wildboar.software/directory/docs/architecture" hreflang="x-default"><link rel="stylesheet" href="/directory/assets/css/styles.e255e738.css">
<link rel="preload" href="/directory/assets/js/runtime~main.54b4f598.js" as="script">
<link rel="preload" href="/directory/assets/js/main.122ea2a4.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/directory/"><div class="navbar__logo"><img src="/directory/img/boar-head-rune-circle.svg" alt="Wildboar Software Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/directory/img/boar-head-rune-circle.svg" alt="Wildboar Software Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Meerkat DSA</b></a><a class="navbar__item navbar__link navbar__link--active" href="/directory/docs/setup">Get Started</a><a class="navbar__item navbar__link navbar__link--active" href="/directory/docs/docs">Documentation</a><a class="navbar__item navbar__link" href="/directory/docs/demo">Demo</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Wildboar-Software/directory" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleChecked_a04y toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" checked="" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/directory/docs/docs">How to use this documentation</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" href="/directory/docs/why-not-ldap">Meerkat DSA</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/why-not-ldap">Why Not LDAP?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/uses">Uses</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/setup">Setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/env">Environment Variables</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/database">Database Administration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/authorization">Authorization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/authentication">Authentication</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/logging-monitoring">Logging and Monitoring</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/schema">Schema Administration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/networking">Networking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/opbinding">Operational Bindings</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/administration">Administration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/advice">Advice</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/usage">Usage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/telemetry">Telemetry</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/conformance">Conformance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/deviations-nuances">Deviations and Nuances</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/information-disclosure">Information Disclosure</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/directory/docs/architecture">Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/roadmap">Roadmap</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/directory/docs/asn1">Reference</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/directory/docs/support">Support / Help</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Architecture</h1></header><h2 class="anchor anchorWithStickyNavbar_y2LR" id="representation-of-the-distinguished-names-in-persistent-storage">Representation of the Distinguished Names in Persistent Storage<a aria-hidden="true" class="hash-link" href="#representation-of-the-distinguished-names-in-persistent-storage" title="Direct link to heading">â€‹</a></h2><p>Directory names do not lend themselves to easy storage and searching in a
traditional database, because the same attribute values may be encoded in
multiple different ways. For instance, strings may be constructed, defaulting
fields of constructed types may be omitted or included, and different types
of length encoding (definite form and indefinite form) may be used. This means
that, in many cases, values can only be stored in the database, but must be
extracted to be evaluated in memory using more sophisticated functions that
no database provides.</p><p>This differs from how OpenLDAP represents distinguished names when using the
SQL backend: the distinguished name is treated as a string and used as a
materialized path.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="why-not-a-document-oriented-database">Why Not a Document-Oriented Database?<a aria-hidden="true" class="hash-link" href="#why-not-a-document-oriented-database" title="Direct link to heading">â€‹</a></h2><p>I wanted Meerkat DSA to support multiple different databases, which I thought
I would be able to do using Prisma. However, it turns out that Prisma does not
lend itself to multiple different databases very well. This part just turned
out to have been a mistake.</p><p>However, I also wanted Meerkat DSA to store data in a form that could be
analyzed, exported, and inspected using popular tools. Databases such as
MongoDB would have been fine (great, even) for storing and searching directory
data, but the tooling around them is limited. There is a lot of existing tools
for analyzing data that is stored in relational databases.</p><p>That said, I still wish that I had used MongoDB. MongoDB&#x27;s dynamism lends
itself better to representing attribute values of multiple different types.
In fact, if MongoDB were used in the first place, attribute drivers would be
almost entirely unnecessary.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="why-do-materialized-paths-end-with-a-period">Why do Materialized Paths end with a period?<a aria-hidden="true" class="hash-link" href="#why-do-materialized-paths-end-with-a-period" title="Direct link to heading">â€‹</a></h2><p>If they did not, searching for <code>1.2.3</code> would also turn up results for <code>1.2.31</code>.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="functional-programming">Functional Programming<a aria-hidden="true" class="hash-link" href="#functional-programming" title="Direct link to heading">â€‹</a></h2><p>Meerkat DSA uses almost exclusively functional programming. Almost every
function takes a &quot;context object.&quot; The context object is like the context
object in Functions-as-a-Service (FaaS) functions, like AWS Lambda functions or
Azure Functions. This context object has pretty much everything that any
function would need implicitly within a directory application: logs,
configuration, telemetry, all current connections, the database client, and
knowledge of all directory schema.</p><p>This looks sort of like a reducer pattern, but it is not quite, since not every
function mutates or even uses the context object. It is used sort of like what
I would call &quot;poor man&#x27;s dependency injection.&quot; Rather than resolving the
dependencies at run time, the context object pattern is type-safe at
build-time.</p><p>The advantage of this pattern is that it makes functions &quot;pure&quot; (or at least
closer to it). You don&#x27;t need to import the logger, for instance, it is passed
into every function as an argument via the context object. It is also very easy
for every function to get access to whatever it needs. Almost every function
has access to the context object and can pass it down to functions that it
calls.</p><p>Examples of this pattern can be seen in OpenSSL and Postfix.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="x518-procedures">X.518 Procedures<a aria-hidden="true" class="hash-link" href="#x518-procedures" title="Direct link to heading">â€‹</a></h2><p>Almost all of the procedures in ITU Recommendation X.518 are represented as a
function in <code>apps/meerkat/src/app/distributed/</code>. Meerkat DSA tries to implement
these procedures as they are specified, even if contemporary coding practices
would lend themselves to different implementations. This is most notable in the
Find DSE procedure, which was implemented the way I imagine such a
procedure would be implemented in C rather than in TypeScript.</p><p>The benefit of doing this is the avoidance of bugs resulting from incorrect
implementation and that most of the code in <code>apps/meerkat/src/app/distributed/</code>
is effectively &quot;already documented&quot; by the steps of the procedures defined in
ITU Recommendation X.518.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/Wildboar-Software/directory/edit/main/website/docs/architecture.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/directory/docs/information-disclosure"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« <!-- -->Information Disclosure</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/directory/docs/roadmap"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Roadmap<!-- --> Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#representation-of-the-distinguished-names-in-persistent-storage" class="table-of-contents__link toc-highlight">Representation of the Distinguished Names in Persistent Storage</a></li><li><a href="#why-not-a-document-oriented-database" class="table-of-contents__link toc-highlight">Why Not a Document-Oriented Database?</a></li><li><a href="#why-do-materialized-paths-end-with-a-period" class="table-of-contents__link toc-highlight">Why do Materialized Paths end with a period?</a></li><li><a href="#functional-programming" class="table-of-contents__link toc-highlight">Functional Programming</a></li><li><a href="#x518-procedures" class="table-of-contents__link toc-highlight">X.518 Procedures</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Wildboar Software. Built with Docusaurus.</div></div></div></footer></div>
<script src="/directory/assets/js/runtime~main.54b4f598.js"></script>
<script src="/directory/assets/js/main.122ea2a4.js"></script>
</body>
</html>