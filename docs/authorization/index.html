<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-authorization" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Authorization | Meerkat DSA</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://wildboar-software.github.io/directory/docs/authorization"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="directory, x500, x.500, ldap, database, meerkat, dsa, distributed"><meta data-rh="true" name="copyright" content="Copyright (c) 2021-2025 Jonathan M. Wilbur &lt;jonathan@wilbur.space&gt;."><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Authorization | Meerkat DSA"><meta data-rh="true" name="description" content="Meerkat supports all access control schemes defined in the X.500 specifications,"><meta data-rh="true" property="og:description" content="Meerkat supports all access control schemes defined in the X.500 specifications,"><link data-rh="true" rel="icon" href="/directory/img/boar-head-rune-circle.svg"><link data-rh="true" rel="canonical" href="https://wildboar-software.github.io/directory/docs/authorization"><link data-rh="true" rel="alternate" href="https://wildboar-software.github.io/directory/docs/authorization" hreflang="en"><link data-rh="true" rel="alternate" href="https://wildboar-software.github.io/directory/docs/authorization" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Authorization","item":"https://wildboar-software.github.io/directory/docs/authorization"}]}</script><link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-177382419-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>



<link rel="icon" href="/directory/img/boar-head-rune-circle.svg">
<link rel="manifest" href="/directory/manifest.json">
<meta name="theme-color" content="rgb(37, 194, 160)"><link rel="stylesheet" href="/directory/assets/css/styles.3a3d7962.css">
<script src="/directory/assets/js/runtime~main.7d85a640.js" defer="defer"></script>
<script src="/directory/assets/js/main.3056611a.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"dark"),document.documentElement.setAttribute("data-theme-choice",t||"dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/directory/img/boar-head-rune-circle-black.svg"><link rel="preload" as="image" href="/directory/img/boar-head-rune-circle.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_G6ar" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/directory/"><div class="navbar__logo"><img src="/directory/img/boar-head-rune-circle-black.svg" alt="Wildboar Software Logo" class="themedComponent_DHUr themedComponent--light_DIHH"><img src="/directory/img/boar-head-rune-circle.svg" alt="Wildboar Software Logo" class="themedComponent_DHUr themedComponent--dark_Bv2M"></div><b class="navbar__title text--truncate">Meerkat DSA</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/directory/docs/setup">Get Started</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/directory/docs/docs">Documentation</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/directory/docs/specs">X.500 Specifications</a><a class="navbar__item navbar__link" href="/directory/docs/demo">Demo</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/Wildboar-Software/directory" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_OLSw colorModeToggle_Hg9V"><button class="clean-btn toggleButton_wYmb toggleButtonDisabled_vaDU" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_KEbZ lightToggleIcon_Sxwe"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_KEbZ darkToggleIcon_Yem1"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_KEbZ systemToggleIcon_txm5"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_bmvg"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_UyTV"><div class="docsWrapper_XLvK"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_z1FD" type="button"></button><div class="docRoot_HciC"><aside class="theme-doc-sidebar-container docSidebarContainer_e5ai"><div class="sidebarViewport_N8x0"><div class="sidebar_vJCc"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_qiME"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/directory/docs/docs"><span title="How to use this documentation" class="linkLabel_PuAu">How to use this documentation</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/directory/docs/intro"><span title="X.500" class="categoryLinkLabel_Oe72">X.500</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/directory/docs/setup"><span title="Meerkat DSA" class="categoryLinkLabel_Oe72">Meerkat DSA</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/setup"><span title="Setup" class="linkLabel_PuAu">Setup</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/env"><span title="Configuration" class="linkLabel_PuAu">Configuration</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/webadmin"><span title="The Web Admin Console" class="linkLabel_PuAu">The Web Admin Console</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/database"><span title="Database Administration" class="linkLabel_PuAu">Database Administration</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/directory/docs/authorization"><span title="Authorization" class="linkLabel_PuAu">Authorization</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/authentication"><span title="Authentication" class="linkLabel_PuAu">Authentication</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/logging-monitoring"><span title="Logging and Monitoring" class="linkLabel_PuAu">Logging and Monitoring</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/schema"><span title="Schema Administration" class="linkLabel_PuAu">Schema Administration</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/networking"><span title="Networking" class="linkLabel_PuAu">Networking</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/distributed"><span title="Distributed Operations" class="linkLabel_PuAu">Distributed Operations</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/tls"><span title="Transport Layer Security (TLS)" class="linkLabel_PuAu">Transport Layer Security (TLS)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/online-pki"><span title="Online PKI" class="linkLabel_PuAu">Online PKI</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/signing"><span title="Signed Operations" class="linkLabel_PuAu">Signed Operations</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/opbinding"><span title="Operational Bindings" class="linkLabel_PuAu">Operational Bindings</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/shadowing"><span title="Shadowing" class="linkLabel_PuAu">Shadowing</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/dynamic"><span title="Dynamic Entries" class="linkLabel_PuAu">Dynamic Entries</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/administration"><span title="Administration" class="linkLabel_PuAu">Administration</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/troubleshooting"><span title="Troubleshooting" class="linkLabel_PuAu">Troubleshooting</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/advice"><span title="Advice" class="linkLabel_PuAu">Advice</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/usage"><span title="Usage" class="linkLabel_PuAu">Usage</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/zonal"><span title="Zonal Matching" class="linkLabel_PuAu">Zonal Matching</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/attr-cert"><span title="Attribute Certificates" class="linkLabel_PuAu">Attribute Certificates</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/conformance"><span title="Conformance" class="linkLabel_PuAu">Conformance</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/deviations-nuances"><span title="Deviations and Nuances" class="linkLabel_PuAu">Deviations and Nuances</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/information-disclosure"><span title="Information Disclosure" class="linkLabel_PuAu">Information Disclosure</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/architecture"><span title="Architecture" class="linkLabel_PuAu">Architecture</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/directory/docs/roadmap"><span title="Roadmap" class="linkLabel_PuAu">Roadmap</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/directory/docs/x500cli"><span title="Clients and Libraries" class="categoryLinkLabel_Oe72">Clients and Libraries</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/directory/docs/tutorial01"><span title="Tutorials" class="categoryLinkLabel_Oe72">Tutorials</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/directory/docs/asn1"><span title="Reference" class="categoryLinkLabel_Oe72">Reference</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/directory/docs/changelog-meerkat"><span title="Change Logs" class="categoryLinkLabel_Oe72">Change Logs</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/directory/docs/versioning"><span title="For Developers" class="categoryLinkLabel_Oe72">For Developers</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/directory/docs/support"><span title="Support / Help" class="linkLabel_PuAu">Support / Help</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_namt"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_YAwJ"><div class="docItemContainer_Rv5Z"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_zCmv" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/directory/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_JFrk"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Meerkat DSA</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Authorization</span></li></ul></nav><div class="tocCollapsible_O_Qc theme-doc-toc-mobile tocMobile_tjDr"><button type="button" class="clean-btn tocCollapsibleButton_htYj">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Authorization</h1></header>
<p>Meerkat supports all access control schemes defined in the X.500 specifications,
meaning:</p>
<ul>
<li class="">Basic Access Control</li>
<li class="">Simplified Access Control</li>
<li class="">Rule-Based Access Control</li>
<li class="">Rule-and-Basic Access Control</li>
<li class="">Rule-and-Simple Access Control.</li>
</ul>
<p>Future versions of Meerkat DSA may introduce new access control schemes, like:</p>
<ul>
<li class="">A &quot;points-based&quot; access control scheme</li>
<li class="">An &quot;OpenLDAP-like&quot; access control scheme</li>
</ul>
<p>This documentation will not discuss how Basic Access Control or Simplified
Access Control works; only the implementation-specific details that apply to
Meerkat DSA.</p>
<h2 class="anchor anchorTargetStickyNavbar_SAay" id="enabling-access-controls">Enabling Access Controls<a href="#enabling-access-controls" class="hash-link" aria-label="Direct link to Enabling Access Controls" title="Direct link to Enabling Access Controls" translate="no">​</a></h2>
<p>Access control does not exist in Meerkat DSA (and the directory as a whole) by
default. It must be configured. For Meerkat DSA to observe access controls for a
given Access Control Specific Area (ACSA), the following must be in place:</p>
<ol>
<li class="">There must be an administrative point defined with an <code>administrativeRole</code>
attribute value of <code>id-ar-autonomousArea</code> (2.5.23.1).</li>
<li class="">There must be an administrative point defined with an <code>administrativeRole</code>
attribute value of <code>id-ar-accessControlSpecificArea</code> (2.5.23.2). The entry
used for this administrative point may be the same as the entry used for the
autonomous administrative point. (An administrative point may have multiple
roles.)</li>
</ol>
<ol start="3">
<li class="">The access control administrative point must have an <code>accessControlScheme</code>
attribute value set to the object identifier of the access control scheme
you want to use in that administrative area.</li>
</ol>
<div class="theme-admonition theme-admonition-warning admonition_IZjC alert alert--warning"><div class="admonitionHeading_uVvU"><span class="admonitionIcon_HiR3"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_bl22"><p>Note that the ACI items should be created before enabling access control. If
there are no ACI items defined at all, then <em>nobody</em> is permitted to do
<em>anything</em>. It is possible for administrators to accidentally configure
rules that prevent even themselves from accessing their own DSA!</p></div></div>
<h2 class="anchor anchorTargetStickyNavbar_SAay" id="getting-locked-out">Getting Locked Out<a href="#getting-locked-out" class="hash-link" aria-label="Direct link to Getting Locked Out" title="Direct link to Getting Locked Out" translate="no">​</a></h2>
<p>If an administrator gets locked out of Meerkat DSA by having misconfigured
access controls, it will have to be corrected by directly modifying the
database to achieve one of the following goals:</p>
<ul>
<li class="">To ensure that one of the conditions stated above for enabling access controls
is no longer met, and thereby disable authorization for that ACSA entirely.</li>
<li class="">To delete the offending ACI item.</li>
</ul>
<p>The former option should be used when administrators don&#x27;t know what they did
wrong, or when the ACSA does not contain any private information; it is quicker
and easier to just disable access control entirely, fix the problem, then
re-enable access controls once it is fixed. If administrators know which ACI
item is causing them to be locked out, the latter option may preferrable.</p>
<p>One way you can &quot;delete&quot; an ACI item is by changing the <code>active</code> column in the
<code>ACIItem</code> table in the database to <code>FALSE</code> for that ACI item.</p>
<h3 class="anchor anchorTargetStickyNavbar_SAay" id="disabling-access-controls">Disabling Access Controls<a href="#disabling-access-controls" class="hash-link" aria-label="Direct link to Disabling Access Controls" title="Direct link to Disabling Access Controls" translate="no">​</a></h3>
<p>The easiest way to do this with minimal loss of data is to delete the
access control scheme attribute value from the <code>EntryAccessControlScheme</code> table.
The administrator will have to determine the ID of the entry that is the
administrative point for the ACSA so he can delete the correct access control
scheme value. It may be helpful to inspect the <code>EntryAdministrativeRole</code> table
to determine the ID of the offending administrative point.</p>
<p>Note that Meerkat DSA will have to be restarted for this change to take effect,
since the access control scheme may still be cached in memory.</p>
<h3 class="anchor anchorTargetStickyNavbar_SAay" id="deleting-an-aci-item-from-the-database">Deleting an ACI Item from the database<a href="#deleting-an-aci-item-from-the-database" class="hash-link" aria-label="Direct link to Deleting an ACI Item from the database" title="Direct link to Deleting an ACI Item from the database" translate="no">​</a></h3>
<p>ACI items may be deleted from the <code>ACIItem</code> table.</p>
<p>Note that Meerkat DSA may have to be restarted for this change to take effect,
since the ACI items may still be cached in memory.</p>
<p>Another way you can &quot;delete&quot; an ACI item is by changing the <code>active</code> column in
the <code>ACIItem</code> table in the database to <code>FALSE</code> for that ACI item.</p>
<h2 class="anchor anchorTargetStickyNavbar_SAay" id="access-controls-in-hierarchical-operational-bindings">Access Controls in Hierarchical Operational Bindings<a href="#access-controls-in-hierarchical-operational-bindings" class="hash-link" aria-label="Direct link to Access Controls in Hierarchical Operational Bindings" title="Direct link to Access Controls in Hierarchical Operational Bindings" translate="no">​</a></h2>
<p>When Meerkat DSA establishes itself as a subordinate DSA in a Hierarchical
Operational Binding (HOB), it will honor all administrative points that lie
within the naming context up until and including the closest Autonomous
Administrative Point (AAP). In other words, if a Meerkat DSA does not define its
newly minted context prefix to be an Autonomous Administrative Point (AAP), it
may be governed by the access controls (and other administrative controls) of
the superior DSA. To be clear, this is the correct behavior for an X.500
directory--not an accidental nuance of Meerkat DSA. Unless you are okay with
the superior DSA having <em>complete control</em> over the subordinate naming context
that you establish with it, you should define each new context prefix to be
an Autonomous Administrative Point (AAP) and each should be an access control
administrative point with the desired access controls configured.</p>
<p>Everything stated above will also apply to Non-Specific Hierarchical Operational
Bindings (NHOBs), even though these are not yet supported in Meerkat DSA.</p>
<p>To clarify with an example, let&#x27;s say that the administrator for C=US wishes to
establish your DSA as the owner of <code>C=US,ST=FL</code> and everything below it. He does
this by submitting an <code>addEntry</code> request to his DSA with <code>targetSystem</code> set to
your DSA, which triggers his DSA to attempt to establish an HOB with your DSA.
If you accept the hierarchical operational binding, the DSA for <code>C=US</code> will now
redirect (chain) all operations within the namespace <code>C=US,ST=FL</code> to your DSA.</p>
<p>If the administrator for <code>C=US</code> has defined an Access Control Specific Area
(ACSA) with <code>C=US</code> as the administrative point that makes <code>C=US,ST=FL,L=Tampa</code>
world-writeable, the DSA for <code>C=US,ST=FL</code> would still honor this configuration,
and permit all writes to <code>C=US,ST=FL,L=Tampa</code> even though the rule permitting it
is external and superior to your DSA. The creation of an
Autonomous Administrative Point (AAP) that halts the propagation of access
control rules (ACI items, for instance) from superior DSAs would prevent this
behavior.</p>
<h2 class="anchor anchorTargetStickyNavbar_SAay" id="recommendation-access-control">Recommendation Access Control<a href="#recommendation-access-control" class="hash-link" aria-label="Direct link to Recommendation Access Control" title="Direct link to Recommendation Access Control" translate="no">​</a></h2>
<p>While DSA administrators will likely use their DSAs differently, there are a few
commonalities particular to access controls that almost all uses of X.500
directory services will find useful. For use common use cases, access controls
should be defined that:</p>
<ul>
<li class="">Allow administrators to administer.</li>
<li class="">Allow users to change their password.<!-- -->
<ul>
<li class="">There are perfectly good arguments to <em>not</em> allowing this, too. It may be
preferrable to have secure system-generated passwords instead; in this case,
administrators should implement access controls that <em>prevent</em> users from
modifying their passwords so that a service can do this on their behalf.</li>
</ul>
</li>
<li class="">Explicitly prohibit users from changing the passwords of others.</li>
<li class="">Explicitly allow administrators to change the passwords of others.</li>
<li class="">Allow users to read their entire entry.<!-- -->
<ul>
<li class="">This should include the child entries if the user&#x27;s entry is a compound
entry.</li>
</ul>
</li>
<li class="">Allow users to modify certain attributes of their entry.<!-- -->
<ul>
<li class="">For example, administrators may not want users to be able to change their
<code>employeeID</code> attribute, but may want to allow users to change their
emergency contact information as they please.</li>
</ul>
</li>
<li class="">Explicitly prohibit users from adding new entries, except within permitted
subtrees.</li>
<li class="">Explicitly prohibit users from modifying or deleting entries that they did not
author.</li>
<li class="">Carefully choose which users can modify <code>hierarchyParent</code> and
<code>aliasedEntryName</code>, because these attributes could be used to initiate attacks
against the directory (e.g. trying to exploit a bug in access control by
using aliases or attempting to enumerate entries with timing attacks via the
<code>hierarchyParent</code> attribute validation.)</li>
<li class="">Explicitly prohibit users from modifying the <code>clearance</code> attribute.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_SAay" id="access-control-in-a-distributed-environment">Access Control in a Distributed Environment<a href="#access-control-in-a-distributed-environment" class="hash-link" aria-label="Direct link to Access Control in a Distributed Environment" title="Direct link to Access Control in a Distributed Environment" translate="no">​</a></h2>
<p>Meerkat DSA makes access control decisions based upon local information, but, in
a distributed environment, authentication information may come from other DSAs.
How this authentication information itself is authenticated is a topic in its
own right, which is documented
<a class="" href="/directory/docs/distributed#authentication-of-distributed-operations">here</a>.</p>
<h2 class="anchor anchorTargetStickyNavbar_SAay" id="setting-the-local-qualifier-of-a-client">Setting the Local Qualifier of a Client<a href="#setting-the-local-qualifier-of-a-client" class="hash-link" aria-label="Direct link to Setting the Local Qualifier of a Client" title="Direct link to Setting the Local Qualifier of a Client" translate="no">​</a></h2>
<p>The meaning of the <code>localQualifier</code> component of the <code>AuthenticationLevel</code> as
described in <a href="https://www.itu.int/rec/T-REC-X.501/en" target="_blank" rel="noopener noreferrer" class="">ITU Recommendation X.501 (2019)</a>,
Section 18.4.2.3, is left to DSA implementations. In Meerkat DSA the
<code>localQualifier</code> is given a value depending on the level of transport security
that is used to protect a connection with a client.</p>
<p>The <code>localQualifier</code> is a simple integer, and Meerkat DSA adds &quot;points&quot; to this
integer, depending on configuration. A different number of points may be granted
for more or less secure transports. For instance, TLSv1.3 could be (and usually
should be) granted more <code>localQualifier</code> &quot;points&quot; than SSLv3, which is
completely insecure (but better than nothing).</p>
<p>The environment variables that are used to configure the <code>localQualifier</code> are:</p>
<ul>
<li class=""><a class="" href="/directory/docs/env#meerkat_local_qualifier_points_for_using_ssl3"><code>MEERKAT_LOCAL_QUALIFIER_POINTS_FOR_USING_SSL3</code></a></li>
<li class=""><a class="" href="/directory/docs/env#meerkat_local_qualifier_points_for_using_starttls"><code>MEERKAT_LOCAL_QUALIFIER_POINTS_FOR_USING_STARTTLS</code></a></li>
<li class=""><a class="" href="/directory/docs/env#meerkat_local_qualifier_points_for_using_tls"><code>MEERKAT_LOCAL_QUALIFIER_POINTS_FOR_USING_TLS</code></a></li>
<li class=""><a class="" href="/directory/docs/env#meerkat_local_qualifier_points_for_using_tls_1_0"><code>MEERKAT_LOCAL_QUALIFIER_POINTS_FOR_USING_TLS_1_0</code></a></li>
<li class=""><a class="" href="/directory/docs/env#meerkat_local_qualifier_points_for_using_tls_1_1"><code>MEERKAT_LOCAL_QUALIFIER_POINTS_FOR_USING_TLS_1_1</code></a></li>
<li class=""><a class="" href="/directory/docs/env#meerkat_local_qualifier_points_for_using_tls_1_2"><code>MEERKAT_LOCAL_QUALIFIER_POINTS_FOR_USING_TLS_1_2</code></a></li>
<li class=""><a class="" href="/directory/docs/env#meerkat_local_qualifier_points_for_using_tls_1_3"><code>MEERKAT_LOCAL_QUALIFIER_POINTS_FOR_USING_TLS_1_3</code></a></li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_SAay" id="rule-based-access-control">Rule-Based Access Control<a href="#rule-based-access-control" class="hash-link" aria-label="Direct link to Rule-Based Access Control" title="Direct link to Rule-Based Access Control" translate="no">​</a></h2>
<p>Rule-Based Access Control is intentionally vague as to how a clearance value is
compared to a security label: it is open-ended by being left to the security
policy to determine how this comparison is performed. This means that Meerkat
DSA must use a means for mapping a security policy identifier (which is an
object identifier) to a function that is used to compare the user&#x27;s clearance
with the security label.</p>
<h3 class="anchor anchorTargetStickyNavbar_SAay" id="controlling-access-to-entries">Controlling Access to Entries<a href="#controlling-access-to-entries" class="hash-link" aria-label="Direct link to Controlling Access to Entries" title="Direct link to Controlling Access to Entries" translate="no">​</a></h3>
<p>The X.500 specifications state that access to a given entry is denied under
Rule-Based Access Control when access to all attribute values is denied.
However, enforcing this would be devastating from a performance perspective.
When performing a <code>list</code> operation, Meerkat DSA would have to check what might
be thousands of attributes per entry. Instead, Meerkat DSA denies access to
an entry if access to any of its distinguished values are denied. This is much
faster, since usually only one single value is evaluated, and it is technically
more strict from a security perspective.</p>
<h3 class="anchor anchorTargetStickyNavbar_SAay" id="where-clearances-come-from">Where Clearances Come From<a href="#where-clearances-come-from" class="hash-link" aria-label="Direct link to Where Clearances Come From" title="Direct link to Where Clearances Come From" translate="no">​</a></h3>
<p>Clearances may be associated with a user in three ways:</p>
<ol>
<li class="">By being present as attribute values of the <code>clearance</code> attribute in the
entry within the bound DSA, so long as the
<a class="" href="/directory/docs/env#meerkat_get_clearances_from_dsait"><code>MEERKAT_GET_CLEARANCES_FROM_DSAIT</code></a>
environment variable is not set to <code>0</code>.</li>
<li class="">By being present as attribute values of the <code>clearance</code> attribute in the
X.509 public key certificate asserted by the user upon successful strong
authentication, so long as the
<a class="" href="/directory/docs/env#meerkat_get_clearances_from_pkc"><code>MEERKAT_GET_CLEARANCES_FROM_PKC</code></a>
environment variable is not set to <code>0</code>.</li>
<li class="">By being present as attribute values of the <code>clearance</code> attribute in the
attribute certificate asserted by the user upon successful strong
authentication, so long as the
<a class="" href="/directory/docs/env#meerkat_get_clearances_from_attr_certs"><code>MEERKAT_GET_CLEARANCES_FROM_ATTR_CERTS</code></a>
environment variable is not set to <code>0</code>.</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_SAay" id="labelling-authorities-and-clearance-authorities">Labelling Authorities and Clearance Authorities<a href="#labelling-authorities-and-clearance-authorities" class="hash-link" aria-label="Direct link to Labelling Authorities and Clearance Authorities" title="Direct link to Labelling Authorities and Clearance Authorities" translate="no">​</a></h3>
<p>Security labels are signed data structures. Their signatures are generally
produced by the public keys of &quot;labelling authorities.&quot; Clearances do not have
to be signed, since they can be taken from the DSAIT, but generally, they should
be signed by being presented in an X.509 public key certificate or attribute
certificate asserted by a user during strong authentication. Thus, for both
verifying security labels and clearance values, there is a need for Meerkat DSA
to have a configurable set of trust anchors explicitly for the purposes of
labelling and clearance issuance.</p>
<p>This can be done by pointing to Trust Anchor List files by using the
<a class="" href="/directory/docs/env#meerkat_clearance_authorities"><code>MEERKAT_CLEARANCE_AUTHORITIES</code></a> and
<a class="" href="/directory/docs/env#meerkat_labelling_authorities"><code>MEERKAT_LABELLING_AUTHORITIES</code></a>
environment variables.</p>
<p>If either of these are unset, they default to the trust anchors used for
signing.</p>
<p>To be used as a labelling authority, the configured trust anchors <strong>MUST</strong> have
a <code>subjectKeyIdentifier</code> extension (or the equivalent <code>keyId</code> field of the
<code>taInfo</code> alternative); those that do not match this requirement will be ignored.</p>
<h3 class="anchor anchorTargetStickyNavbar_SAay" id="the-simple-security-policy">The Simple Security Policy<a href="#the-simple-security-policy" class="hash-link" aria-label="Direct link to The Simple Security Policy" title="Direct link to The Simple Security Policy" translate="no">​</a></h3>
<p>For the sake of easy use of the Rule-Based Access Control (RBAC), Meerkat DSA
comes with a security policy built-in, called the &quot;simple security policy.&quot;
It&#x27;s object identifier is <code>1.3.6.1.4.1.56490.5.403.1</code>. This security policy does
nothing with security categories, and permits access to the labeled attribute
value if the clearance level is greater than or equal to the clearance level
required by the labeled attribute value. Unless you plan to make use of security
categories, this should be a sensible default for most use cases.</p>
<p>The Simple Security Policy treats the &quot;unmarked&quot; classification as being of
higher sensitivity than &quot;unclassified,&quot; but of lesser sensitivity than
&quot;restricted.&quot; The rationale for this is that &quot;unclassified&quot; explicitly names
something as having the most relaxed classification, whereas &quot;unmarked&quot; is an
absence of information, but it may also indicate that the labeled thing is not
important enough to have labeled properly in the first place, hence, it lies
between total declassification and the &quot;restricted&quot; classification.</p>
<p>The Simple Security Policy does not treat reads and writes differently: if
access is granted to read an entry, access is also granted to modify an entry.
There is an exception, however: any modification operation that affects a value
with security labels MUST be performed with top-secret clearance.</p>
<div class="theme-admonition theme-admonition-note admonition_IZjC alert alert--secondary"><div class="admonitionHeading_uVvU"><span class="admonitionIcon_HiR3"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_bl22"><p>If no security policy is listed in the security label or clearance, it defaults
to the Simple Security Policy described above.</p></div></div>
<h3 class="anchor anchorTargetStickyNavbar_SAay" id="custom-security-policies">Custom Security Policies<a href="#custom-security-policies" class="hash-link" aria-label="Direct link to Custom Security Policies" title="Direct link to Custom Security Policies" translate="no">​</a></h3>
<p>If you want to define your own security policies, you may do so in the
<a class="" href="/directory/docs/env#meerkat_init_js">init script</a> like demonstrated below.</p>
<div class="language-javascript codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-javascript codeBlock_TAPP thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// This is the object identifier of your security policy.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> your_security_policy_id </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;1.3.6.1.4.1.99999.1&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// The is the Access Control Decision Function (ACDF) for your security policy.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// This determines how a clearance value compares to a security label.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> your_custom_acdf </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// Context</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    assn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// ClientAssociation // This has a clearance field.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    target</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// Vertex</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    signedLabel</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// SignedSecurityLabel</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// ASN1Element</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    contexts</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// X500Context[]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    permissions</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// number[]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token operator">:</span><span class="token plain"> </span><span class="token parameter">boolean</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> label </span><span class="token operator">=</span><span class="token plain"> signedLabel</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">toBeSigned</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">securityLabel</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> classification </span><span class="token operator">=</span><span class="token plain"> </span><span class="token known-class-name class-name">Number</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">label</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">security_classification</span><span class="token plain"> </span><span class="token operator">??</span><span class="token plain"> </span><span class="token maybe-class-name">SecurityClassification_unmarked</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">classification </span><span class="token operator">===</span><span class="token plain"> </span><span class="token maybe-class-name">SecurityClassification_unclassified</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// If unclassified, the user may always see it.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> </span><span class="token literal-property property">highestClearanceLevel</span><span class="token operator">:</span><span class="token plain"> number </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// Note that a client may be associated with multiple clearance values.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// How you handle this is up to you.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> clearance </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">of</span><span class="token plain"> assn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">clearances</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token operator">!</span><span class="token plain">clearance</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">policyId</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">toString</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">!==</span><span class="token plain"> your_security_policy_id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token comment" style="color:rgb(98, 114, 164)">// We ignore clearances that do not pertain to this security policy.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">continue</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> </span><span class="token literal-property property">clearanceLevel</span><span class="token operator">:</span><span class="token plain"> </span><span class="token maybe-class-name">SecurityClassification</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token operator">!</span><span class="token plain">clearance</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">classList</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token maybe-class-name">SecurityClassification_unclassified</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">clearance</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">classList</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token maybe-class-name">ClassList_topSecret</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">===</span><span class="token plain"> </span><span class="token constant" style="color:rgb(189, 147, 249)">TRUE_BIT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token maybe-class-name">SecurityClassification_top_secret</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">clearance</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">classList</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token maybe-class-name">ClassList_secret</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">===</span><span class="token plain"> </span><span class="token constant" style="color:rgb(189, 147, 249)">TRUE_BIT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token maybe-class-name">SecurityClassification_secret</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">clearance</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">classList</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token maybe-class-name">ClassList_confidential</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">===</span><span class="token plain"> </span><span class="token constant" style="color:rgb(189, 147, 249)">TRUE_BIT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token maybe-class-name">SecurityClassification_confidential</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">clearance</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">classList</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token maybe-class-name">ClassList_restricted</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">===</span><span class="token plain"> </span><span class="token constant" style="color:rgb(189, 147, 249)">TRUE_BIT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token maybe-class-name">SecurityClassification_restricted</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">clearance</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">classList</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token maybe-class-name">ClassList_unmarked</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">===</span><span class="token plain"> </span><span class="token constant" style="color:rgb(189, 147, 249)">TRUE_BIT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token maybe-class-name">SecurityClassification_unmarked</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token maybe-class-name">SecurityClassification_unclassified</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">clearanceLevel </span><span class="token operator">&gt;</span><span class="token plain"> highestClearanceLevel</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            highestClearanceLevel </span><span class="token operator">=</span><span class="token plain"> </span><span class="token known-class-name class-name">Number</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">clearanceLevel</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// Just to make sure that classification cannot be given a large,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// illegitimate value to make a protected value universally inaccessible.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">highestClearanceLevel </span><span class="token operator">==</span><span class="token plain"> </span><span class="token maybe-class-name">SecurityClassification_top_secret</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">highestClearanceLevel </span><span class="token operator">&gt;=</span><span class="token plain"> classification</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">async</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">init</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">// Here, we associate the policy ID with the ACDF</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">rbacPolicies</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">set</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">your_security_policy_id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> your_custom_acdf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">// This is just logging, just to show you that you can do this. :)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Added my own custom security policy&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">export</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">default</span><span class="token plain"> init</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre></div></div>
<p>The Access Control Decision Function (ACDF) associated with the security policy
takes several arguments associated with the user, attribute value, contexts, the
DSA itself, and returns a <code>boolean</code>: if this <code>boolean</code> is <code>true</code>, it means that
the user&#x27;s access request was granted; if <code>false</code>, the requested access is
denied.</p>
<h3 class="anchor anchorTargetStickyNavbar_SAay" id="chaining-rule-based-access-control">Chaining Rule-Based Access Control<a href="#chaining-rule-based-access-control" class="hash-link" aria-label="Direct link to Chaining Rule-Based Access Control" title="Direct link to Chaining Rule-Based Access Control" translate="no">​</a></h3>
<p>The clearances associated with a user are not preserved across the DSA boundary:
they are not chained. With Basic Access Control and Simplified Access Control,
the user&#x27;s authentication level can be relayed to other DSAs, but there is no
defined mechanism for a users clearances to survive across chaining. As such,
Rule-Based Access Control is only viable for regulating access within a single
DSA.</p>
<p>For security reasons, only DAP and LDAP associations will have any clearances
associated: this is so that downstream DSAs do not make access control decisions
on the basis of the upstream DSA&#x27;s clearances rather than the originating DAP
requester when chaining is used.</p>
<h3 class="anchor anchorTargetStickyNavbar_SAay" id="users-with-no-clearance">Users with No Clearance<a href="#users-with-no-clearance" class="hash-link" aria-label="Direct link to Users with No Clearance" title="Direct link to Users with No Clearance" translate="no">​</a></h3>
<p>Users with no clearances at all will automatically be given access only to
attribute values having a security label with a class of <code>unclassified</code>.</p>
<h3 class="anchor anchorTargetStickyNavbar_SAay" id="invalid-hashes-untrusted-labels-and-untrusted-labelling-authorities">Invalid Hashes, Untrusted Labels, and Untrusted Labelling Authorities<a href="#invalid-hashes-untrusted-labels-and-untrusted-labelling-authorities" class="hash-link" aria-label="Direct link to Invalid Hashes, Untrusted Labels, and Untrusted Labelling Authorities" title="Direct link to Invalid Hashes, Untrusted Labels, and Untrusted Labelling Authorities" translate="no">​</a></h3>
<p>In Meerkat DSA, an invalid hash, invalid signature, or untrusted labelling
authority having issued a security label will make the security label
inaccessible to all users not having top-secret clearance for the identified
security policy.</p>
<div class="theme-admonition theme-admonition-info admonition_IZjC alert alert--info"><div class="admonitionHeading_uVvU"><span class="admonitionIcon_HiR3"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_bl22"><p>When establishing the above behavior, I had--broadly speaking--two choices:</p><ol>
<li class="">Generally allow access (with possible caveats) when a security label is
invalid for some reason.</li>
<li class="">Generally deny access (with possible caveats) when a security label is
invalid for some reason.</li>
</ol><p>If I chose option 1, there would be a risk of disclosing classified information
as a result of accidentally malformed labels or bugs in the DER encoding,
hashing, or signing. If I chose option 2, there would be a risk of nefarious
users either creating illegitimate labels or copying otherwise legitimate
labels from correct values to cripple directory access to legitimate users.</p><p>I chose option 2 for these reasons:</p><ol>
<li class="">Not all malformed labels are malicious; some are produced by accident, and
the risk of accidentally disclosing classified information could be much
greater than temporarily having lost access to part of the directory.</li>
<li class="">Since labelled values are generally going to be created by people that
already have clearance for that information, there would be no immediate
feedback to indicate that something was wrong if access were granted for
invalid labels; the value would still appear to that user as expected. By
restricting access for invalid labels, there may be a visible consequence
that users can seek to rectify.</li>
<li class="">There is no real way to know if a label is valid until you submit it to
Meerkat DSA. This means that users would have to add the classified
information to Meerkat DSA, then determine if the labels are valid after the
fact being checking if the classified information is disclosed to
unauthorized users.</li>
<li class="">At least with the Simple Security Policy, modifying security labels in the
first place is only granted to users with top-secret clearance.</li>
</ol></div></div>
<p>Note that, as a result of the above, changing the configured
<a class="" href="/directory/docs/env#meerkat_labelling_authorities">labelling authorities</a> could invalidate
existing security labels, making values &quot;disappear&quot; to users that would
otherwise have access to them.</p>
<h3 class="anchor anchorTargetStickyNavbar_SAay" id="unrecognized-policies">Unrecognized Policies<a href="#unrecognized-policies" class="hash-link" aria-label="Direct link to Unrecognized Policies" title="Direct link to Unrecognized Policies" translate="no">​</a></h3>
<p>When Meerkat DSA encounters an unrecognized policy on a security label, it
only grants access to the protected value if the label indicates that the
item is <code>unclassified</code> or if the user has top-secret clearance.</p>
<h3 class="anchor anchorTargetStickyNavbar_SAay" id="multiple-security-labels">Multiple Security Labels<a href="#multiple-security-labels" class="hash-link" aria-label="Direct link to Multiple Security Labels" title="Direct link to Multiple Security Labels" translate="no">​</a></h3>
<p><a href="https://www.itu.int/rec/T-REC-X.501/en" target="_blank" rel="noopener noreferrer" class="">ITU Recommendation X.501 (2019)</a>
mandates a limit of one security label context per value. Meerkat DSA does not
enforce this. The behavior of Meerkat DSA in the presence of multiple security
labels for a given value will remain undefined, but it usually results in the
first one being used exclusively, and the remainder ignored.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_HJkF"><a href="https://github.com/Wildboar-Software/directory/edit/main/website/docs/authorization.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_UohW" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_g62E"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/directory/docs/database"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Database Administration</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/directory/docs/authentication"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Authentication</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_TN1Q thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#enabling-access-controls" class="table-of-contents__link toc-highlight">Enabling Access Controls</a></li><li><a href="#getting-locked-out" class="table-of-contents__link toc-highlight">Getting Locked Out</a><ul><li><a href="#disabling-access-controls" class="table-of-contents__link toc-highlight">Disabling Access Controls</a></li><li><a href="#deleting-an-aci-item-from-the-database" class="table-of-contents__link toc-highlight">Deleting an ACI Item from the database</a></li></ul></li><li><a href="#access-controls-in-hierarchical-operational-bindings" class="table-of-contents__link toc-highlight">Access Controls in Hierarchical Operational Bindings</a></li><li><a href="#recommendation-access-control" class="table-of-contents__link toc-highlight">Recommendation Access Control</a></li><li><a href="#access-control-in-a-distributed-environment" class="table-of-contents__link toc-highlight">Access Control in a Distributed Environment</a></li><li><a href="#setting-the-local-qualifier-of-a-client" class="table-of-contents__link toc-highlight">Setting the Local Qualifier of a Client</a></li><li><a href="#rule-based-access-control" class="table-of-contents__link toc-highlight">Rule-Based Access Control</a><ul><li><a href="#controlling-access-to-entries" class="table-of-contents__link toc-highlight">Controlling Access to Entries</a></li><li><a href="#where-clearances-come-from" class="table-of-contents__link toc-highlight">Where Clearances Come From</a></li><li><a href="#labelling-authorities-and-clearance-authorities" class="table-of-contents__link toc-highlight">Labelling Authorities and Clearance Authorities</a></li><li><a href="#the-simple-security-policy" class="table-of-contents__link toc-highlight">The Simple Security Policy</a></li><li><a href="#custom-security-policies" class="table-of-contents__link toc-highlight">Custom Security Policies</a></li><li><a href="#chaining-rule-based-access-control" class="table-of-contents__link toc-highlight">Chaining Rule-Based Access Control</a></li><li><a href="#users-with-no-clearance" class="table-of-contents__link toc-highlight">Users with No Clearance</a></li><li><a href="#invalid-hashes-untrusted-labels-and-untrusted-labelling-authorities" class="table-of-contents__link toc-highlight">Invalid Hashes, Untrusted Labels, and Untrusted Labelling Authorities</a></li><li><a href="#unrecognized-policies" class="table-of-contents__link toc-highlight">Unrecognized Policies</a></li><li><a href="#multiple-security-labels" class="table-of-contents__link toc-highlight">Multiple Security Labels</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022-2025 Wildboar Software. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>